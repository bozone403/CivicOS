import{j as e}from"./ui-B-8yHimL.js";import{c as q,q as J,y as K,p as W,r as k,g as d,h as o,i as h,n as m,j as x,B as g,S as X,L as t,I as n,O as D,s as Z,o as _,E as $,w as T}from"./index-C9gybLZn.js";import{S as c}from"./switch-3W7B1Dko.js";import{A as V,a as R}from"./alert-hDJTqqKs.js";import{r as l}from"./vendor-DRd396Ms.js";import{A as ee,a as se,b as ae}from"./avatar-MvsCt6kw.js";import{L as ie}from"./lock-DmE5ew3a.js";import{C as re}from"./check-uDgP4aU3.js";import{S as te}from"./smartphone-COSH0mbI.js";import{G as ne}from"./globe-D649daUW.js";import"./index-Bfvbq57u.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=q("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ge(){var U;const{user:i}=J(),z=K(),{toast:u}=W(),[p,j]=l.useState({email:!0,push:!1,sms:!1,bills:!0,elections:!0,petitions:!1}),[v,P]=l.useState({publicProfile:!1,showVotes:!1,showLocation:!0}),[r,N]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[F,f]=l.useState(""),[B,C]=l.useState(!1),[b,E]=l.useState(null),[G,A]=l.useState(null),M=l.useRef(null);if(!i)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Please log in to view your settings."});const w=k({mutationFn:async s=>await(await T("/api/auth/change-password","POST",s)).json(),onSuccess:()=>{N({currentPassword:"",newPassword:"",confirmPassword:""}),f(""),C(!0),u({title:"Password Changed",description:"Your password has been updated successfully"}),setTimeout(()=>C(!1),3e3)},onError:s=>{f(s.message||"Failed to change password"),C(!1)}});k({mutationFn:async s=>i?T("/api/users/profile","PUT",s):Promise.reject("No user"),onSuccess:()=>{z.invalidateQueries({queryKey:["/api/auth/user"]}),u({title:"Profile updated!",description:"Your changes have been saved."})}});const H=s=>{if(s.preventDefault(),f(""),!r.currentPassword||!r.newPassword||!r.confirmPassword){f("All password fields are required");return}if(r.newPassword!==r.confirmPassword){f("New passwords do not match");return}if(r.newPassword.length<6){f("New password must be at least 6 characters");return}w.mutate({currentPassword:r.currentPassword,newPassword:r.newPassword})},S=k({mutationFn:async s=>{const a=new FormData;a.append("profilePicture",s);const y=await fetch("/api/auth/upload-profile-picture",{method:"POST",body:a});if(!y.ok)throw new Error("Failed to upload profile picture");return await y.json()},onSuccess:()=>{u({title:"Profile Picture Updated",description:"Your profile picture has been updated successfully"}),E(null),A(null),window.location.reload()},onError:s=>{u({title:"Upload Failed",description:s.message||"Failed to upload profile picture",variant:"destructive"})}}),O=s=>{var y;const a=(y=s.target.files)==null?void 0:y[0];if(a){if(a.size>5*1024*1024){u({title:"File Too Large",description:"Please select an image smaller than 5MB",variant:"destructive"});return}if(!a.type.startsWith("image/")){u({title:"Invalid File Type",description:"Please select an image file",variant:"destructive"});return}E(a);const I=new FileReader;I.onload=Q=>{var L;A((L=Q.target)==null?void 0:L.result)},I.readAsDataURL(a)}},Y=()=>{b&&S.mutate(b)};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account preferences and privacy settings"})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Profile Picture"})]}),e.jsx(m,{children:"Update your profile picture"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs(ee,{className:"w-24 h-24",children:[e.jsx(se,{src:G||(i==null?void 0:i.profileImageUrl)}),e.jsx(ae,{className:"text-2xl",children:((U=i==null?void 0:i.firstName)==null?void 0:U[0])||"U"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:M,type:"file",accept:"image/*",onChange:O,className:"hidden"}),e.jsxs(g,{onClick:()=>{var s;return(s=M.current)==null?void 0:s.click()},variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"Choose New Picture"})]}),b&&e.jsx(g,{onClick:Y,disabled:S.isPending,className:"w-full",children:S.isPending?"Uploading...":"Save Profile Picture"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload a JPG, PNG, or GIF. Max file size: 5MB"})]})]})})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-5 w-5"}),e.jsx("span",{children:"Account Information"})]}),e.jsx(m,{children:"Update your personal information"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"firstName",children:"First Name"}),e.jsx(n,{id:"firstName",defaultValue:(i==null?void 0:i.firstName)||"",placeholder:"Enter your first name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"lastName",children:"Last Name"}),e.jsx(n,{id:"lastName",defaultValue:(i==null?void 0:i.lastName)||"",placeholder:"Enter your last name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"email",children:"Email Address"}),e.jsx(n,{id:"email",type:"email",defaultValue:(i==null?void 0:i.email)||"",placeholder:"Enter your email",autoComplete:"username"})]}),e.jsx(g,{children:"Save Changes"})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{children:"Password Security"})]}),e.jsx(m,{children:"Change your account password"})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[F&&e.jsx(V,{variant:"destructive",children:e.jsx(R,{children:F})}),B&&e.jsxs(V,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx(R,{children:"Password changed successfully!"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(n,{id:"currentPassword",type:"password",value:r.currentPassword,onChange:s=>N(a=>({...a,currentPassword:s.target.value})),placeholder:"Enter current password",disabled:w.isPending,autoComplete:"current-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"newPassword",children:"New Password"}),e.jsx(n,{id:"newPassword",type:"password",value:r.newPassword,onChange:s=>N(a=>({...a,newPassword:s.target.value})),placeholder:"Enter new password (min 6 characters)",disabled:w.isPending,autoComplete:"new-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(n,{id:"confirmPassword",type:"password",value:r.confirmPassword,onChange:s=>N(a=>({...a,confirmPassword:s.target.value})),placeholder:"Confirm new password",disabled:w.isPending,autoComplete:"new-password"})]}),e.jsx(g,{type:"submit",disabled:w.isPending,className:"bg-slate-800 hover:bg-slate-700",children:w.isPending?"Updating...":"Change Password"})]})})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("span",{children:"Notification Preferences"})]}),e.jsx(m,{children:"Choose how you want to be notified about civic activities"})]}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Notification Methods"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Email notifications"})]}),e.jsx(c,{checked:p.email,onCheckedChange:s=>j(a=>({...a,email:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Push notifications"})]}),e.jsx(c,{checked:p.push,onCheckedChange:s=>j(a=>({...a,push:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"SMS notifications"})]}),e.jsx(c,{checked:p.sms,onCheckedChange:s=>j(a=>({...a,sms:s}))})]})]})]}),e.jsx(_,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Content Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"New bills and legislation"}),e.jsx(c,{checked:p.bills,onCheckedChange:s=>j(a=>({...a,bills:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Election updates"}),e.jsx(c,{checked:p.elections,onCheckedChange:s=>j(a=>({...a,elections:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Petition milestones"}),e.jsx(c,{checked:p.petitions,onCheckedChange:s=>j(a=>({...a,petitions:s}))})]})]})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-5 w-5"}),e.jsx("span",{children:"Privacy Settings"})]}),e.jsx(m,{children:"Control what information is visible to others"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow others to see your civic engagement stats"})]}),e.jsx(c,{checked:v.publicProfile,onCheckedChange:s=>P(a=>({...a,publicProfile:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Show Voting History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Display your votes on bills and petitions"})]}),e.jsx(c,{checked:v.showVotes,onCheckedChange:s=>P(a=>({...a,showVotes:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Location-based Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Show relevant local politicians and issues"})]}),e.jsx(c,{checked:v.showLocation,onCheckedChange:s=>P(a=>({...a,showLocation:s}))})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Regional Preferences"})]}),e.jsx(m,{children:"Customize content for your location"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"province",children:"Province/Territory"}),e.jsx(n,{id:"province",placeholder:"Select your province",defaultValue:"Ontario"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"riding",children:"Federal Riding"}),e.jsx(n,{id:"riding",placeholder:"Enter your riding"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"municipality",children:"Municipality"}),e.jsx(n,{id:"municipality",placeholder:"Enter your city/town"})]})]})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(h,{className:"text-red-600",children:"Account Actions"}),e.jsx(m,{children:"Manage your account status"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-red-700",children:"Permanently delete your account and all associated data"})]}),e.jsx(g,{variant:"destructive",size:"sm",children:"Delete Account"})]})})]})]})})})}export{ge as default};
