import{r,j as e}from"./ui-D2Re0T6U.js";import{z as K,q as W,E as X,p as Z,r as F,g as o,h as m,i as h,n as x,j as p,R as _,W as $,X as ee,B as w,S as se,L as n,I as c,J as ae,a4 as T,t as ie,o as te,G as re,y as E}from"./app-BYR0VHFY.js";import{S as l}from"./switch-DQW6v1lR.js";import{A as q,a as G}from"./alert-HCr0t2fp.js";import{C as ne}from"./camera-B843_WwH.js";import{L as ce}from"./lock-D7Fsl6Ui.js";import{S as le}from"./smartphone-B2Zx-Wok.js";import{G as de}from"./globe-0clVrOKW.js";import"./vendor-BtP0CW_r.js";import"./index-B4pxPuSB.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=K("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ye(){var L;const{user:i}=W(),A=X(),{toast:g}=Z(),[u,j]=r.useState({email:!0,push:!1,sms:!1,bills:!0,elections:!0,petitions:!1}),[C,S]=r.useState({publicProfile:!1,showVotes:!1,showLocation:!0}),[t,N]=r.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[U,f]=r.useState(""),[z,k]=r.useState(!1),[y,I]=r.useState(null),[B,M]=r.useState(null),D=r.useRef(null);if(!i)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Please log in to view your settings."});const d=F({mutationFn:async s=>await E("/api/auth/change-password","POST",s),onSuccess:()=>{N({currentPassword:"",newPassword:"",confirmPassword:""}),f(""),k(!0),g({title:"Password Changed",description:"Your password has been updated successfully"}),setTimeout(()=>k(!1),3e3)},onError:s=>{f(s.message||"Failed to change password"),k(!1)}}),v=F({mutationFn:async s=>i?E("/api/users/profile","PUT",s):Promise.reject("No user"),onSuccess:()=>{A.invalidateQueries({queryKey:["/api/auth/user"]}),g({title:"Profile updated!",description:"Your changes have been saved."})}}),H=r.useCallback(s=>{if(s.preventDefault(),f(""),!t.currentPassword||!t.newPassword||!t.confirmPassword){f("All password fields are required");return}if(t.newPassword!==t.confirmPassword){f("New passwords do not match");return}if(t.newPassword.length<6){f("New password must be at least 6 characters");return}d.mutate({currentPassword:t.currentPassword,newPassword:t.newPassword})},[t,d]),O=r.useCallback(s=>{s.preventDefault();const a=new FormData(s.target),b={firstName:a.get("firstName"),lastName:a.get("lastName"),email:a.get("email")};v.mutate(b)},[v]),Q=r.useCallback(s=>{var b;const a=(b=s.target.files)==null?void 0:b[0];if(a){I(a);const R=new FileReader;R.onload=J=>{var V;return M((V=J.target)==null?void 0:V.result)},R.readAsDataURL(a)}},[]),P=F({mutationFn:async s=>{const a=new FormData;return a.append("profileImage",s),await E("/api/users/profile-picture","POST",a)},onSuccess:()=>{A.invalidateQueries({queryKey:["/api/auth/user"]}),I(null),M(null),g({title:"Profile picture updated!",description:"Your new profile picture has been saved."})},onError:s=>{g({title:"Upload failed",description:s.message||"Failed to upload profile picture",variant:"destructive"})}}),Y=r.useCallback(()=>{y&&P.mutate(y)},[y,P]);return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage your account preferences and privacy settings"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Profile Picture"})]}),e.jsx(x,{children:"Update your profile picture"})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs(_,{className:"w-24 h-24",children:[e.jsx($,{src:B||(i==null?void 0:i.profileImageUrl)}),e.jsx(ee,{className:"text-2xl",children:typeof(i==null?void 0:i.firstName)=="string"?(L=i==null?void 0:i.firstName)==null?void 0:L[0]:"U"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:D,type:"file",accept:"image/*",onChange:Q,className:"hidden"}),e.jsxs(w,{onClick:()=>{var s;return(s=D.current)==null?void 0:s.click()},variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Choose New Picture"})]}),y&&e.jsx(w,{onClick:Y,disabled:P.isPending,className:"w-full",children:P.isPending?"Uploading...":"Save Profile Picture"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload a JPG, PNG, or GIF. Max file size: 5MB"})]})]})})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("span",{children:"Account Information"})]}),e.jsx(x,{children:"Update your personal information"})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-profile-first-name",children:"First Name"}),e.jsx(c,{id:"settings-profile-first-name",name:"firstName",defaultValue:(i==null?void 0:i.firstName)||"",placeholder:"Enter your first name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-profile-last-name",children:"Last Name"}),e.jsx(c,{id:"settings-profile-last-name",name:"lastName",defaultValue:(i==null?void 0:i.lastName)||"",placeholder:"Enter your last name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-profile-email",children:"Email Address"}),e.jsx(c,{id:"settings-profile-email",name:"email",type:"email",defaultValue:(i==null?void 0:i.email)||"",placeholder:"Enter your email",autoComplete:"username"})]}),e.jsx(w,{type:"submit",disabled:v.isPending,children:v.isPending?"Saving...":"Save Changes"})]})})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Password Security"})]}),e.jsx(x,{children:"Change your account password"})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[U&&e.jsx(q,{variant:"destructive",children:e.jsx(G,{children:U})}),z&&e.jsxs(q,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(G,{children:"Password changed successfully!"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-current-password",children:"Current Password"}),e.jsx(c,{id:"settings-current-password",type:"password",value:t.currentPassword,onChange:s=>N(a=>({...a,currentPassword:s.target.value})),placeholder:"Enter current password",disabled:d.isPending,autoComplete:"current-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-new-password",children:"New Password"}),e.jsx(c,{id:"settings-new-password",type:"password",value:t.newPassword,onChange:s=>N(a=>({...a,newPassword:s.target.value})),placeholder:"Enter new password (min 6 characters)",disabled:d.isPending,autoComplete:"new-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-confirm-password",children:"Confirm New Password"}),e.jsx(c,{id:"settings-confirm-password",type:"password",value:t.confirmPassword,onChange:s=>N(a=>({...a,confirmPassword:s.target.value})),placeholder:"Confirm new password",disabled:d.isPending,autoComplete:"new-password"})]}),e.jsx(w,{type:"submit",disabled:d.isPending,className:"bg-slate-800 hover:bg-slate-700",children:d.isPending?"Updating...":"Change Password"})]})})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"h-5 w-5"}),e.jsx("span",{children:"Notification Preferences"})]}),e.jsx(x,{children:"Choose how you want to be notified about civic activities"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Notification Methods"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Email notifications"})]}),e.jsx(l,{checked:u.email,onCheckedChange:s=>j(a=>({...a,email:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Push notifications"})]}),e.jsx(l,{checked:u.push,onCheckedChange:s=>j(a=>({...a,push:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"SMS notifications"})]}),e.jsx(l,{checked:u.sms,onCheckedChange:s=>j(a=>({...a,sms:s}))})]})]})]}),e.jsx(te,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Content Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"New bills and legislation"}),e.jsx(l,{checked:u.bills,onCheckedChange:s=>j(a=>({...a,bills:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Election updates"}),e.jsx(l,{checked:u.elections,onCheckedChange:s=>j(a=>({...a,elections:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Petition milestones"}),e.jsx(l,{checked:u.petitions,onCheckedChange:s=>j(a=>({...a,petitions:s}))})]})]})]})]})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Privacy Settings"})]}),e.jsx(x,{children:"Control what information is visible to others"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow others to see your civic engagement stats"})]}),e.jsx(l,{checked:C.publicProfile,onCheckedChange:s=>S(a=>({...a,publicProfile:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Show Voting History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Display your votes on bills and petitions"})]}),e.jsx(l,{checked:C.showVotes,onCheckedChange:s=>S(a=>({...a,showVotes:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Location-based Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Show relevant local politicians and issues"})]}),e.jsx(l,{checked:C.showLocation,onCheckedChange:s=>S(a=>({...a,showLocation:s}))})]})]})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-5 w-5"}),e.jsx("span",{children:"Regional Preferences"})]}),e.jsx(x,{children:"Customize content for your location"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-province-input",children:"Province/Territory"}),e.jsx(c,{id:"settings-province-input",placeholder:"Select your province",defaultValue:"Ontario"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-riding-input",children:"Federal Riding"}),e.jsx(c,{id:"settings-riding-input",placeholder:"Enter your riding"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"settings-municipality-input",children:"Municipality"}),e.jsx(c,{id:"settings-municipality-input",placeholder:"Enter your city/town"})]})]})]}),e.jsxs(o,{children:[e.jsxs(m,{children:[e.jsx(h,{className:"text-red-600",children:"Account Actions"}),e.jsx(x,{children:"Manage your account status"})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-red-700",children:"Permanently delete your account and all associated data"})]}),e.jsx(w,{variant:"destructive",size:"sm",children:"Delete Account"})]})})]})]})]})})}export{ye as default};
