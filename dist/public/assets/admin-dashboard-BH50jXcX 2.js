import{r as I,j as e}from"./ui-D2Re0T6U.js";import{q as B,p as z,E as H,K as w,r as m,S as Y,g as i,h as n,i as l,U as P,j as c,F as M,N as E,V as R,Q as _,n as x,aw as U,B as h,ai as J,y as d}from"./app-CDP34tcP.js";import{T as W,a as X,b as u,c as j}from"./tabs-CDqV0ldV.js";import{A as Z,a as $}from"./alert-CQ54MNk_.js";import{R as g}from"./refresh-cw-BqvEZ_Cm.js";import{U as ee}from"./user-check-snwCHvQj.js";import{F as K}from"./flag-iUCfvAKS.js";import{T as se}from"./trending-up-DqzJ9oa9.js";import"./vendor-BtP0CW_r.js";function he(){var C,L,T,A,F,S,q;const{user:ae,isAuthenticated:D}=B(),{toast:r}=z(),o=H(),[Q,k]=I.useState("overview"),{data:p,isLoading:O}=w({queryKey:["admin-access"],queryFn:async()=>{try{return await d("/api/admin/summary","GET"),!0}catch{return!1}},enabled:D}),{data:s,isLoading:V}=w({queryKey:["admin-summary"],queryFn:async()=>(await d("/api/admin/summary","GET")).summary,enabled:p,refetchInterval:3e4}),{data:t,isLoading:te}=w({queryKey:["ingestion-status"],queryFn:async()=>await d("/api/admin/ingestion/status","GET"),enabled:p,refetchInterval:6e4}),f=m({mutationFn:async()=>await d("/api/admin/refresh/news","POST"),onSuccess:()=>{r({title:"News refreshed",description:"News feeds have been updated successfully."}),o.invalidateQueries({queryKey:["news"]})},onError:a=>{r({title:"Failed to refresh news",description:a.message||"Please try again.",variant:"destructive"})}}),N=m({mutationFn:async()=>await d("/api/admin/refresh/parliament","POST"),onSuccess:()=>{r({title:"Parliament data refreshed",description:"Parliament members and votes have been updated."}),o.invalidateQueries({queryKey:["politicians"]}),o.invalidateQueries({queryKey:["bills"]})},onError:a=>{r({title:"Failed to refresh parliament data",description:a.message||"Please try again.",variant:"destructive"})}}),v=m({mutationFn:async()=>await d("/api/admin/refresh/legal","POST"),onSuccess:()=>{r({title:"Legal data refreshed",description:"Legal acts and cases have been updated."}),o.invalidateQueries({queryKey:["legal"]})},onError:a=>{r({title:"Failed to refresh legal data",description:a.message||"Please try again.",variant:"destructive"})}}),y=m({mutationFn:async()=>await d("/api/admin/refresh/procurement","POST"),onSuccess:()=>{r({title:"Procurement data refreshed",description:"Procurement contracts have been updated."}),o.invalidateQueries({queryKey:["procurement"]})},onError:a=>{r({title:"Failed to refresh procurement data",description:a.message||"Please try again.",variant:"destructive"})}}),b=m({mutationFn:async()=>await d("/api/admin/refresh/lobbyists","POST"),onSuccess:()=>{r({title:"Lobbyist data refreshed",description:"Lobbyist organizations have been updated."}),o.invalidateQueries({queryKey:["lobbyists"]})},onError:a=>{r({title:"Failed to refresh lobbyist data",description:a.message||"Please try again.",variant:"destructive"})}});return O||V?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((a,G)=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},G))})]})})}):p?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Manage your CivicOS platform and monitor system health"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(P,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((C=s==null?void 0:s.users)==null?void 0:C.toLocaleString())||"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Registered users"})]})]}),e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Content"}),e.jsx(M,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(((s==null?void 0:s.posts)||0)+((s==null?void 0:s.comments)||0)).toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s==null?void 0:s.posts)||0," posts, ",(s==null?void 0:s.comments)||0," comments"]})]})]}),e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"News Articles"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((L=s==null?void 0:s.news)==null?void 0:L.toLocaleString())||"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Published articles"})]})]}),e.jsxs(i,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm font-medium",children:"Votes"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:((T=s==null?void 0:s.votes)==null?void 0:T.toLocaleString())||"0"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"User votes cast"})]})]})]}),e.jsxs(W,{value:Q,onValueChange:k,className:"space-y-6",children:[e.jsxs(X,{className:"grid w-full grid-cols-5",children:[e.jsx(u,{value:"overview",children:"Overview"}),e.jsx(u,{value:"data",children:"Data Management"}),e.jsx(u,{value:"users",children:"User Management"}),e.jsx(u,{value:"moderation",children:"Moderation"}),e.jsx(u,{value:"analytics",children:"Analytics"})]}),e.jsx(j,{value:"overview",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx("span",{children:"System Status"})]}),e.jsx(x,{children:"Current platform health and data ingestion status"})]}),e.jsx(c,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((A=t==null?void 0:t.users)==null?void 0:A.toLocaleString())||"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Users"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((F=t==null?void 0:t.politicians)==null?void 0:F.toLocaleString())||"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Politicians"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:((S=t==null?void 0:t.legalActs)==null?void 0:S.toLocaleString())||"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Legal Acts"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:((q=t==null?void 0:t.legalCases)==null?void 0:q.toLocaleString())||"0"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Legal Cases"})]})]})})]})}),e.jsx(j,{value:"data",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{children:"Data Ingestion"})]}),e.jsx(x,{children:"Manually trigger data updates from external sources"})]}),e.jsx(c,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(h,{onClick:()=>f.mutate(),disabled:f.isPending,className:"w-full",children:[f.isPending?e.jsx(g,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(E,{className:"h-4 w-4 mr-2"}),"Refresh News"]}),e.jsxs(h,{onClick:()=>N.mutate(),disabled:N.isPending,className:"w-full",children:[N.isPending?e.jsx(g,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(R,{className:"h-4 w-4 mr-2"}),"Refresh Parliament Data"]}),e.jsxs(h,{onClick:()=>v.mutate(),disabled:v.isPending,className:"w-full",children:[v.isPending?e.jsx(g,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(M,{className:"h-4 w-4 mr-2"}),"Refresh Legal Data"]}),e.jsxs(h,{onClick:()=>y.mutate(),disabled:y.isPending,className:"w-full",children:[y.isPending?e.jsx(g,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(U,{className:"h-4 w-4 mr-2"}),"Refresh Procurement"]}),e.jsxs(h,{onClick:()=>b.mutate(),disabled:b.isPending,className:"w-full",children:[b.isPending?e.jsx(g,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(P,{className:"h-4 w-4 mr-2"}),"Refresh Lobbyists"]})]})})]})}),e.jsx(j,{value:"users",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"User Management"})]}),e.jsx(x,{children:"Manage user accounts, permissions, and verification"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"User management features coming soon"})]})})]})}),e.jsx(j,{value:"moderation",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"h-5 w-5"}),e.jsx("span",{children:"Content Moderation"})]}),e.jsx(x,{children:"Review and moderate user-generated content"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(K,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"Content moderation features coming soon"})]})})]})}),e.jsx(j,{value:"analytics",className:"space-y-6",children:e.jsxs(i,{children:[e.jsxs(n,{children:[e.jsxs(l,{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-5 w-5"}),e.jsx("span",{children:"Platform Analytics"})]}),e.jsx(x,{children:"View detailed platform usage and performance metrics"})]}),e.jsx(c,{children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(se,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"Analytics dashboard coming soon"})]})})]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(Z,{className:"mt-20",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx($,{children:"Access denied. You do not have permission to view the admin dashboard."})]})})})}export{he as default};
