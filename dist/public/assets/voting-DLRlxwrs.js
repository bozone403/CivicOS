import{j as e}from"./ui-B-8yHimL.js";import{r as L}from"./vendor-DRd396Ms.js";import{c as me,q as he,p as ue,z as pe,H as N,r as M,g as l,j as i,T as je,F as E,_ as O,l as ge,I as Ne,h as d,E as x,C as ye,B as c,i as q,w as o,U as ve,m as A,$ as fe,a0 as be,S as we,Z as Ce,k as Se}from"./index-BHMGHw3l.js";import{P as F}from"./progress-ZqO5ijE-.js";import{T as Ve,a as Pe,b as H,c as U}from"./tabs-8_iDk-XD.js";import{S as $,a as R,b as Y,c as Z,d as y}from"./select-BmC-GR98.js";import{C as Te}from"./circle-x-Ct279hix.js";import{T as _,a as J}from"./thumbs-up-DTBB7a4f.js";import{S as Le}from"./star-DApslF8k.js";import{G as Ee}from"./globe-BTnGTOYf.js";import"./index-Bfvbq57u.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=me("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);function He(){var I,z;const{isAuthenticated:k}=he(),{toast:n}=ue(),v=pe(),[m,W]=L.useState(""),[f,ee]=L.useState("all"),[b,se]=L.useState("all"),{data:h=[],isLoading:ae,error:te}=N({queryKey:["/api/voting/bills"],queryFn:()=>o("/api/voting/bills","GET")}),{data:B=[],isLoading:re,error:le}=N({queryKey:["/api/voting/electoral/candidates"],queryFn:()=>o("/api/voting/electoral/candidates","GET")}),{data:r,isLoading:qe}=N({queryKey:["/api/voting/electoral/results"],queryFn:()=>o("/api/voting/electoral/results","GET")}),{data:w,isLoading:Ae}=N({queryKey:["/api/voting/electoral/trends"],queryFn:()=>o("/api/voting/electoral/trends","GET")}),u=M({mutationFn:s=>o("/api/voting/bills/vote","POST",s),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/voting/bills"]}),n({title:"Vote recorded!",description:"Your vote has been successfully recorded."})},onError:s=>{n({title:"Vote failed",description:s.message||"Failed to record your vote. Please try again.",variant:"destructive"})}}),p=M({mutationFn:s=>o("/api/voting/electoral/vote","POST",s),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/voting/electoral/candidates"]}),v.invalidateQueries({queryKey:["/api/voting/electoral/results"]}),n({title:"Electoral vote recorded!",description:"Your electoral preference has been recorded."})},onError:s=>{n({title:"Electoral vote failed",description:s.message||"Failed to record your electoral vote. Please try again.",variant:"destructive"})}}),C=(s,a)=>{if(!k){n({title:"Authentication required",description:"Please log in to vote on bills.",variant:"destructive"});return}u.mutate({billId:s,vote:a})},S=(s,a,t)=>{if(!k){n({title:"Authentication required",description:"Please log in to vote on electoral candidates.",variant:"destructive"});return}p.mutate({candidateId:s,voteType:a,reasoning:t})},V=h.filter(s=>{const a=s.title.toLowerCase().includes(m.toLowerCase())||s.description.toLowerCase().includes(m.toLowerCase())||s.billNumber.toLowerCase().includes(m.toLowerCase()),t=f==="all"||s.category===f,g=b==="all"||s.status===b;return a&&t&&g}),P=(s,a)=>a>0?Math.round(s/a*100):0,ie=s=>{const a=s.userVotes||{yes:0,no:0,abstain:0},t=s.totalVotes||0;return{yes:a.yes||0,no:a.no||0,abstain:a.abstain||0,total:t}},j=s=>{const a=s.voteStats||{preference:0,support:0,oppose:0,total:0};return{preference:a.preference||0,support:a.support||0,oppose:a.oppose||0,total:a.total||0}},ne=s=>({Environment:Ee,Justice:Se,Technology:Ce,"Indigenous Rights":we,Finance:be,Healthcare:fe,Education:A,Transportation:A,Housing:A,Immigration:ve})[s]||E,ce=s=>({"Liberal Party":"bg-red-100 text-red-800 border-red-200","Conservative Party":"bg-blue-100 text-blue-800 border-blue-200","New Democratic Party":"bg-orange-100 text-orange-800 border-orange-200","Bloc Québécois":"bg-teal-100 text-teal-800 border-teal-200","Green Party":"bg-green-100 text-green-800 border-green-200"})[s]||"bg-gray-100 text-gray-800 border-gray-200",oe=s=>{switch(s.toLowerCase()){case"active":return"bg-green-100 text-green-800";case"passed":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};if(ae||re)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"animate-pulse space-y-6",children:[...Array(6)].map((s,a)=>e.jsx(l,{children:e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},a))})});if(te||le)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(je,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Voting Data"}),e.jsx("p",{className:"text-gray-600",children:"Unable to load voting information at this time. Please try again later."})]})})})});const de=Array.from(new Set(h.map(s=>s.category))),xe=Array.from(new Set(h.map(s=>s.status)));return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Democratic Voting Platform"}),e.jsx("p",{className:"text-gray-600",children:"Cast your vote on bills and electoral candidates"})]}),e.jsxs(Ve,{defaultValue:"bills",className:"space-y-6",children:[e.jsxs(Pe,{className:"grid w-full grid-cols-2",children:[e.jsxs(H,{value:"bills",className:"flex items-center space-x-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Bills & Legislation"})]}),e.jsxs(H,{value:"electoral",className:"flex items-center space-x-2",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:"Electoral Voting"})]})]}),e.jsxs(U,{value:"bills",className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Ne,{placeholder:"Search bills...",value:m,onChange:s=>W(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs($,{value:f,onValueChange:ee,children:[e.jsx(R,{className:"w-48",children:e.jsx(Y,{placeholder:"Filter by category"})}),e.jsxs(Z,{children:[e.jsx(y,{value:"all",children:"All Categories"}),de.map(s=>e.jsx(y,{value:s,children:s},s))]})]}),e.jsxs($,{value:b,onValueChange:se,children:[e.jsx(R,{className:"w-48",children:e.jsx(Y,{placeholder:"Filter by status"})}),e.jsxs(Z,{children:[e.jsx(y,{value:"all",children:"All Statuses"}),xe.map(s=>e.jsx(y,{value:s,children:s},s))]})]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-gray-600",children:["Showing ",V.length," of ",h.length," bills"]})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:V.map(s=>{const a=ne(s.category),{yes:t,no:g,abstain:D,total:T}=ie(s),K=P(t,T),Q=P(g,T),G=P(D,T);return e.jsxs(l,{className:"bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(d,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(a,{className:"w-5 h-5 text-blue-600"}),e.jsx(x,{variant:"outline",className:"text-xs",children:s.category}),e.jsx(x,{className:`text-xs ${oe(s.status)}`,children:s.status})]}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:[s.billNumber,": ",s.title]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description})]})})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Stage:"}),e.jsx("p",{className:"font-medium",children:s.stage})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Sponsor:"}),e.jsxs("p",{className:"font-medium",children:[s.sponsor," (",s.sponsorParty,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Introduced:"}),e.jsx("p",{className:"font-medium",children:new Date(s.introducedDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Timeline:"}),e.jsx("p",{className:"font-medium",children:s.timeline})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Vote Results:"}),e.jsxs("span",{className:"font-medium",children:[s.totalVotes," total votes"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Support"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",K,"%)"]})]})]}),e.jsx(F,{value:K,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm",children:"Oppose"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:g}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",Q,"%)"]})]})]}),e.jsx(F,{value:Q,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm",children:"Abstain"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:D}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",G,"%)"]})]})]}),e.jsx(F,{value:G,className:"h-2"})]})]}),e.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(c,{size:"sm",variant:s.userVote==="yes"?"default":"outline",onClick:()=>C(s.id,"yes"),disabled:u.isPending,children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"Support"]}),e.jsxs(c,{size:"sm",variant:s.userVote==="no"?"default":"outline",onClick:()=>C(s.id,"no"),disabled:u.isPending,children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),"Oppose"]}),e.jsxs(c,{size:"sm",variant:s.userVote==="abstain"?"default":"outline",onClick:()=>C(s.id,"abstain"),disabled:u.isPending,children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Abstain"]})]})})]})})]},s.id)})}),V.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No bills found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria."})]})]}),e.jsxs(U,{value:"electoral",className:"space-y-6",children:[r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(q,{className:"text-lg",children:"Total Votes"})}),e.jsxs(i,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:r.totalVotes||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Citizens participated"})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(q,{className:"text-lg",children:"Recent Activity"})}),e.jsxs(i,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:(w==null?void 0:w.recentVotes)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Votes this week"})]})]}),e.jsxs(l,{children:[e.jsx(d,{children:e.jsx(q,{className:"text-lg",children:"Top Candidate"})}),e.jsxs(i,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:((I=r==null?void 0:r.topCandidate)==null?void 0:I.name)||"N/A"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[((z=r==null?void 0:r.topCandidate)==null?void 0:z.totalVotes)||0," votes"]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:B.map(s=>e.jsxs(l,{className:"bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(d,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(x,{className:`text-xs ${ce(s.party)}`,children:s.party}),e.jsxs(x,{variant:"outline",className:"text-xs",children:["Trust: ",s.trustScore]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.position})]})})}),e.jsx(i,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:s.bio}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Preference Votes:"}),e.jsx("span",{className:"font-medium",children:j(s).preference})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Support Votes:"}),e.jsx("span",{className:"font-medium",children:j(s).support})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Oppose Votes:"}),e.jsx("span",{className:"font-medium",children:j(s).oppose})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm font-medium",children:[e.jsx("span",{children:"Total Votes:"}),e.jsx("span",{children:j(s).total})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Key Policies:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.keyPolicies.slice(0,3).map((a,t)=>e.jsx(x,{variant:"secondary",className:"text-xs",children:a},t))})]}),e.jsx("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(c,{size:"sm",onClick:()=>S(s.id,"preference"),disabled:p.isPending,children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),"Prefer"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>S(s.id,"support"),disabled:p.isPending,children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"Support"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>S(s.id,"oppose"),disabled:p.isPending,children:[e.jsx(J,{className:"w-4 h-4 mr-1"}),"Oppose"]})]})})]})})]},s.id))}),B.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(O,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No electoral candidates found"}),e.jsx("p",{className:"text-gray-600",children:"Electoral candidates will appear here when available."})]})]})]})]})})}export{He as default};
