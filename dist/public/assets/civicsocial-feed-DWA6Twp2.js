import{j as e}from"./ui-CDUWW_Ri.js";import{r as a}from"./vendor-1XCZ5AD1.js";import{z as re,q as ce,p as de,E as ue,K as me,r as c,B as i,R as he,D as xe,a as pe,b as je,c as ve,d as ye,L as k,$ as ge,a1 as fe,M as Se,ai as R,a2 as Ne,y as o,aj as be,l as Pe,I as Ce}from"./index-CxE8SzRb.js";import{S as j,a as v,b as y,c as g,d as t}from"./select-BwiA_mBG.js";import{C as f,a as we,b as Te,c as ke,d,e as Fe,f as Le,T as Me,g as qe}from"./CivicSocialCard-BI66wX4F.js";import{P as F}from"./plus-CjX_SOua.js";import{T as Ve}from"./tag-BBgJGhMj.js";import{C as Ie}from"./camera-D5AscQUY.js";import{T as Oe}from"./trending-up-BN4VkyLc.js";import"./index-q7PMzjPi.js";import"./bookmark-C_WwDjhf.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function Ze(){const{user:Ee,isAuthenticated:Qe}=ce(),{toast:u}=de(),r=ue(),[B,n]=a.useState(!1),[L,Re]=a.useState("following"),[S,A]=a.useState("all"),[M,K]=a.useState(""),[q,U]=a.useState("latest"),[m,V]=a.useState(""),[I,O]=a.useState("post"),[D,E]=a.useState("public"),[z,$]=a.useState([]),[Y,H]=a.useState(""),[W,G]=a.useState(""),[Be,N]=a.useState(null),[h,b]=a.useState(null),{data:P,isLoading:C,error:J,refetch:Q}=me({queryKey:["socialFeed",L,S,q,M],queryFn:async()=>{const s=L==="following"?"following":S==="public"?"public":"all",l=new URLSearchParams({scope:s});return(await o(`/api/social/feed?${l.toString()}`)).feed||[]},staleTime:3e4}),w=c({mutationFn:async s=>await o("/api/social/posts","POST",s),onSuccess:()=>{r.invalidateQueries({queryKey:["socialFeed"]}),n(!1),ne(),u({title:"Post created!",description:"Your post has been shared successfully."})},onError:s=>{u({title:"Error creating post",description:s.message||"Failed to create post. Please try again.",variant:"destructive"})}}),X=c({mutationFn:async s=>await o(`/api/social/posts/${s}/like`,"POST"),onSuccess:()=>{r.invalidateQueries({queryKey:["socialFeed"]})}});c({mutationFn:async({postId:s,content:l})=>await o(`/api/social/posts/${s}/comment`,"POST",{content:l}),onSuccess:()=>{r.invalidateQueries({queryKey:["socialFeed"]})}});const Z=c({mutationFn:async s=>await o(`/api/social/posts/${s}/share`,"POST"),onSuccess:()=>{r.invalidateQueries({queryKey:["socialFeed"]}),u({title:"Post shared!",description:"Your post has been shared successfully."})}}),_=c({mutationFn:async s=>await o("/api/social/bookmarks","POST",{postId:s}),onSuccess:()=>{r.invalidateQueries({queryKey:["socialFeed"]})}}),ee=async s=>{if(s.preventDefault(),!m.trim())return;const l={content:m,type:I,visibility:D,tags:z,location:Y,mood:W,...h&&{imageUrl:h}};w.mutate(l)},se=s=>{X.mutate(s)},te=s=>{console.log("Commenting on post:",s),u({title:"Comment posted",description:"Your comment has been posted successfully!"})},ae=s=>{Z.mutate(s)},ie=s=>{_.mutate(s)},le=s=>{var T;const l=(T=s.target.files)==null?void 0:T[0];l&&(N(l),b(URL.createObjectURL(l)))},ne=()=>{V(""),O("post"),E("public"),$([]),H(""),G(""),N(null),b(null)},x=e.jsxs(e.Fragment,{children:[e.jsx(d,{title:"Quick Actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(i,{onClick:()=>n(!0),className:"w-full social-button-primary",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create Post"]}),e.jsxs(i,{variant:"outline",className:"w-full",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Share Photo"]}),e.jsxs(i,{variant:"outline",className:"w-full",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Share Video"]})]})}),e.jsx(d,{title:"Trending Topics",children:e.jsx("div",{className:"space-y-2",children:["#CanadianPolitics","#CivicEngagement","#Democracy","#VotingRights"].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50 hover:bg-muted transition-colors cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium",children:s}),e.jsx(Oe,{className:"w-4 h-4 text-muted-foreground"})]},s))})}),e.jsx(d,{title:"Online Friends",children:e.jsx("div",{className:"space-y-2",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-md hover:bg-muted transition-colors cursor-pointer",children:[e.jsx("div",{className:"social-avatar-online w-8 h-8",children:e.jsxs("div",{className:"w-full h-full rounded-full bg-social-primary flex items-center justify-center text-white text-xs font-medium",children:["U",s]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium truncate",children:["User ",s]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Online"})]})]},s))})})]}),p=e.jsx(qe,{title:"CivicSocial Feed",subtitle:"Stay connected with your civic community",actions:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Q(),disabled:C,children:C?e.jsx(R,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4"})}),e.jsxs(i,{onClick:()=>n(!0),className:"social-button-primary",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"New Post"]})]})}),oe=e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 p-4 bg-card border border-border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Ce,{placeholder:"Search posts...",value:M,onChange:s=>K(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{value:S,onValueChange:s=>A(s),children:[e.jsx(v,{className:"w-32",children:e.jsx(y,{})}),e.jsxs(g,{children:[e.jsx(t,{value:"all",children:"All Posts"}),e.jsx(t,{value:"public",children:"Public"}),e.jsx(t,{value:"friends",children:"Friends"}),e.jsx(t,{value:"private",children:"Private"})]})]}),e.jsxs(j,{value:q,onValueChange:s=>U(s),children:[e.jsx(v,{className:"w-32",children:e.jsx(y,{})}),e.jsxs(g,{children:[e.jsx(t,{value:"latest",children:"Latest"}),e.jsx(t,{value:"popular",children:"Popular"}),e.jsx(t,{value:"trending",children:"Trending"})]})]})]})]});return C?e.jsx(f,{header:p,sidebar:x,children:e.jsx(we,{title:"Loading your feed...",description:"We're gathering the latest posts from your civic community."})}):J?e.jsx(f,{header:p,sidebar:x,children:e.jsx(Te,{title:"Failed to load feed",description:"We couldn't load your social feed. Please check your connection and try again.",retry:()=>Q()})}):!P||P.length===0?e.jsx(f,{header:p,sidebar:x,children:e.jsx(ke,{title:"No posts yet",description:"Be the first to share something with your civic community!",icon:e.jsx(he,{className:"w-8 h-8"}),action:e.jsxs(i,{onClick:()=>n(!0),className:"social-button-primary",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Create Your First Post"]})})}):e.jsxs(f,{header:p,sidebar:x,children:[e.jsx(d,{children:oe}),e.jsx(d,{children:e.jsx(Fe,{children:P.map(s=>e.jsx(Le,{post:s,onLike:se,onComment:te,onShare:ae,onBookmark:ie},s.id))})}),e.jsx(xe,{open:B,onOpenChange:n,children:e.jsxs(pe,{className:"max-w-2xl",children:[e.jsxs(je,{children:[e.jsx(ve,{children:"Create a New Post"}),e.jsx(ye,{children:"Share your thoughts, ideas, or updates with the civic community."})]}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"content",children:"What's on your mind?"}),e.jsx(ge,{id:"content",placeholder:"Share your thoughts with the civic community...",value:m,onChange:s=>V(s.target.value),className:"min-h-[120px]",required:!0})]}),h&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h,alt:"Preview",className:"w-full rounded-lg max-h-64 object-cover"}),e.jsx(i,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{N(null),b(null)},children:e.jsx(Me,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"type",children:"Post Type"}),e.jsxs(j,{value:I,onValueChange:s=>O(s),children:[e.jsx(v,{children:e.jsx(y,{})}),e.jsxs(g,{children:[e.jsx(t,{value:"post",children:"Post"}),e.jsx(t,{value:"share",children:"Share"}),e.jsx(t,{value:"poll",children:"Poll"}),e.jsx(t,{value:"event",children:"Event"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"visibility",children:"Visibility"}),e.jsxs(j,{value:D,onValueChange:s=>E(s),children:[e.jsx(v,{children:e.jsx(y,{})}),e.jsxs(g,{children:[e.jsx(t,{value:"public",children:"Public"}),e.jsx(t,{value:"friends",children:"Friends"}),e.jsx(t,{value:"private",children:"Private"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>{var s;return(s=document.getElementById("image-upload"))==null?void 0:s.click()},children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Add Image"]}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",onChange:le,className:"hidden"}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Add Location"]}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Add Tags"]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(i,{type:"submit",className:"social-button-primary",disabled:w.isPending||!m.trim(),children:[w.isPending?e.jsx(R,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]})})]})}export{Ze as default};
