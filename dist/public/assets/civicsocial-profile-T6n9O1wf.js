import{j as e}from"./ui-CDUWW_Ri.js";import{r as i}from"./vendor-1XCZ5AD1.js";import{z as ne,q as re,p as oe,E as de,r as me,B as t,ap as Q,Q as Y,s as P,$ as W,a4 as xe,R as L,t as ue,v as he,W as je,D as pe,a as fe,b as ve,c as ge,d as Ne,I as F,y as ye}from"./index-DCaV-fkU.js";import{u as be,a as we,b as Ce,c as Se,d as Pe,e as Le}from"./useCivicSocial-BViTp7hh.js";import{d as c,h as $,C as I,a as Fe,b as Ie,i as H,c as k,e as ke,f as Ae,j as Te,g as Ee}from"./CivicSocialCard-BESY_Urc.js";import{T as Me,a as Ue,b as u,c as h}from"./tabs-DZpOfPUv.js";import{C as Be}from"./camera-CzsM-VGa.js";import{A as K}from"./award-CXA51OWB.js";import{T as Re}from"./trash-2-B3uue635.js";import"./bookmark-DMH_NQWI.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=ne("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);function Xe(){const{user:s,isLoading:G,isAuthenticated:De}=re(),{data:T,isLoading:V,error:J}=be(),{data:j}=we(),p=Ce(),X=Se();Pe(),Le();const[m,E]=i.useState(""),[M,Z]=i.useState({}),[Oe,ze]=i.useState({}),[f,v]=i.useState(null),[o,g]=i.useState(null),[_,d]=i.useState(!1),[U,ee]=i.useState((s==null?void 0:s.firstName)||""),[B,se]=i.useState((s==null?void 0:s.lastName)||""),[R,ae]=i.useState((s==null?void 0:s.bio)||""),[D,ie]=i.useState((s==null?void 0:s.profileImageUrl)||""),O=i.useRef(null),{toast:l}=oe(),z=de(),N=(j==null?void 0:j.friends)||[],[te,q]=i.useState("posts"),y=me({mutationFn:async a=>ye("/api/users/profile","PUT",a),onSuccess:()=>{z.invalidateQueries({queryKey:["/api/auth/user"]}),d(!1),l({title:"Profile updated!",description:"Your changes have been saved."})}}),b=T?T.filter(a=>String(a.userId)===String(s==null?void 0:s.id)):[],w=s?s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.firstName||s.lastName||s.email||"Anonymous":"Anonymous",le=a=>{var x;const r=(x=a.target.files)==null?void 0:x[0];r&&(v(r),g(URL.createObjectURL(r)))},ce=async a=>{if(a.preventDefault(),!m.trim()&&!f)return;let r=null;f&&(r=o),p.mutate({content:m,userId:s==null?void 0:s.id,displayName:w,imageUrl:r},{onSuccess:()=>{l({title:"Post created!",description:"Your post was added to your wall."}),z.invalidateQueries({queryKey:["civicSocialFeed"]})},onError:x=>{l({title:"Error posting",description:x.message||"Failed to post.",variant:"destructive"})}}),E(""),v(null),g(null)},n={posts:b.length,friends:N.length,civicPoints:(s==null?void 0:s.civicPoints)||0},C=e.jsx(Ee,{title:"My Profile",subtitle:"Manage your civic social presence",actions:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>d(!0),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),e.jsxs(t,{variant:"outline",size:"sm",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Settings"]})]})}),S=e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Profile Info",children:e.jsx($,{user:{id:(s==null?void 0:s.id)||"",firstName:s==null?void 0:s.firstName,lastName:s==null?void 0:s.lastName,email:(s==null?void 0:s.email)||"",profileImageUrl:s==null?void 0:s.profileImageUrl,civicLevel:s==null?void 0:s.civicLevel,bio:s==null?void 0:s.bio,isOnline:!0},stats:n,onMessage:()=>l({title:"Message feature",description:"Messaging coming soon!"}),onFollow:()=>l({title:"Follow feature",description:"Follow functionality coming soon!"})})}),e.jsx(c,{title:"Quick Actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(t,{onClick:()=>d(!0),className:"w-full social-button-primary",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Edit Profile"]}),e.jsxs(t,{variant:"outline",className:"w-full",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Change Photo"]}),e.jsxs(t,{variant:"outline",className:"w-full",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Privacy Settings"]})]})}),e.jsx(c,{title:"Activity Stats",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"w-4 h-4 text-social-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Posts"})]}),e.jsx("span",{className:"text-lg font-bold text-social-primary",children:n.posts})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"w-4 h-4 text-social-secondary"}),e.jsx("span",{className:"text-sm font-medium",children:"Friends"})]}),e.jsx("span",{className:"text-lg font-bold text-social-secondary",children:n.friends})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{className:"w-4 h-4 text-social-accent"}),e.jsx("span",{className:"text-sm font-medium",children:"Civic Points"})]}),e.jsx("span",{className:"text-lg font-bold text-social-accent",children:n.civicPoints})]})]})})]});return G||V?e.jsx(I,{header:C,sidebar:S,children:e.jsx(Fe,{title:"Loading your profile...",description:"We're gathering your profile information and posts."})}):J?e.jsx(I,{header:C,sidebar:S,children:e.jsx(Ie,{title:"Failed to load profile",description:"We couldn't load your profile information. Please check your connection and try again.",retry:()=>window.location.reload()})}):e.jsxs(I,{header:C,sidebar:S,children:[e.jsx(c,{children:e.jsxs(Me,{value:te,onValueChange:q,children:[e.jsxs(Ue,{className:"grid w-full grid-cols-4",children:[e.jsx(u,{value:"posts",children:"Posts"}),e.jsx(u,{value:"about",children:"About"}),e.jsx(u,{value:"friends",children:"Friends"}),e.jsx(u,{value:"activity",children:"Activity"})]}),e.jsxs(h,{value:"posts",className:"mt-6",children:[e.jsx(c,{title:"Create New Post",children:e.jsx(H,{children:e.jsx("form",{onSubmit:ce,className:"space-y-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"social-avatar w-10 h-10",children:o?e.jsx("img",{src:o,alt:"Preview",className:"w-full h-full rounded-full object-cover"}):e.jsx("div",{className:"w-full h-full rounded-full bg-social-primary flex items-center justify-center text-white font-medium",children:w.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx(W,{placeholder:"What's on your mind?",value:m,onChange:a=>E(a.target.value),className:"min-h-[100px] resize-none"}),o&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:o,alt:"Preview",className:"w-full rounded-lg max-h-64 object-cover"}),e.jsx(t,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{v(null),g(null)},children:e.jsx(Re,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(t,{type:"button",variant:"outline",size:"sm",onClick:()=>{var a;return(a=O.current)==null?void 0:a.click()},children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Image"]}),e.jsx("input",{ref:O,type:"file",accept:"image/*",onChange:le,className:"hidden"})]}),e.jsxs(t,{type:"submit",className:"social-button-primary",disabled:p.isPending||!m.trim()&&!f,children:[p.isPending?e.jsx("div",{className:"w-4 h-4 animate-spin border-2 border-white border-t-transparent rounded-full mr-2"}):e.jsx(L,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]})})})}),e.jsx(c,{title:"Your Posts",children:b.length===0?e.jsx(k,{title:"No posts yet",description:"Start sharing your civic thoughts and experiences!",icon:e.jsx(L,{className:"w-8 h-8"}),action:e.jsxs(t,{onClick:()=>q("posts"),className:"social-button-primary",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Create Your First Post"]})}):e.jsx(ke,{children:b.map(a=>e.jsx(Ae,{post:a,onLike:()=>X.mutate(a.id),onComment:()=>Z({...M,[a.id]:!M[a.id]}),onShare:()=>l({title:"Share feature",description:"Sharing coming soon!"}),onBookmark:()=>l({title:"Bookmark feature",description:"Bookmarking coming soon!"})},a.id))})})]}),e.jsx(h,{value:"about",className:"mt-6",children:e.jsx(c,{title:"About Me",children:e.jsx(H,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"social-heading-3 text-card-foreground mb-2",children:"Personal Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(P,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Name:"}),e.jsx("span",{className:"text-sm font-medium",children:w})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ue,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Email:"}),e.jsx("span",{className:"text-sm font-medium",children:s==null?void 0:s.email})]}),(s==null?void 0:s.civicLevel)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Civic Level:"}),e.jsx(he,{className:"social-badge-primary",children:s.civicLevel})]})]})]}),(s==null?void 0:s.bio)&&e.jsxs("div",{children:[e.jsx("h4",{className:"social-heading-3 text-card-foreground mb-2",children:"Bio"}),e.jsx("p",{className:"social-body text-muted-foreground",children:s.bio})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"social-heading-3 text-card-foreground mb-2",children:"Activity Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Posts Created"}),e.jsx("span",{className:"text-lg font-bold text-social-primary",children:n.posts})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Friends"}),e.jsx("span",{className:"text-lg font-bold text-social-secondary",children:n.friends})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Civic Points"}),e.jsx("span",{className:"text-lg font-bold text-social-accent",children:n.civicPoints})]})]})]})})]})})})})}),e.jsx(h,{value:"friends",className:"mt-6",children:e.jsx(c,{title:"My Friends",children:N.length===0?e.jsx(k,{title:"No friends yet",description:"Connect with other civic-minded individuals!",icon:e.jsx(P,{className:"w-8 h-8"}),action:e.jsxs(t,{className:"social-button-primary",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Find Friends"]})}):e.jsx(Te,{cols:3,children:N.map(a=>e.jsx($,{user:{id:a.id,firstName:a.firstName,lastName:a.lastName,email:a.email,profileImageUrl:a.profileImageUrl,civicLevel:a.civicLevel,isOnline:a.isOnline},onMessage:()=>l({title:"Message feature",description:"Messaging coming soon!"}),onFollow:()=>l({title:"Follow feature",description:"Follow functionality coming soon!"})},a.id))})})}),e.jsx(h,{value:"activity",className:"mt-6",children:e.jsx(c,{title:"Recent Activity",children:e.jsx(k,{title:"No recent activity",description:"Your civic engagement activity will appear here.",icon:e.jsx(Y,{className:"w-8 h-8"})})})})]})}),e.jsx(pe,{open:_,onOpenChange:d,children:e.jsxs(fe,{className:"max-w-2xl",children:[e.jsxs(ve,{children:[e.jsx(ge,{children:"Edit Profile"}),e.jsx(Ne,{children:"Update your profile information and preferences."})]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),y.mutate({firstName:U,lastName:B,bio:R,profileImageUrl:D})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"First Name"}),e.jsx(F,{value:U,onChange:a=>ee(a.target.value),placeholder:"First name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Last Name"}),e.jsx(F,{value:B,onChange:a=>se(a.target.value),placeholder:"Last name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Bio"}),e.jsx(W,{value:R,onChange:a=>ae(a.target.value),placeholder:"Tell us about yourself...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Profile Image URL"}),e.jsx(F,{value:D,onChange:a=>ie(a.target.value),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsxs(t,{type:"submit",className:"social-button-primary",disabled:y.isPending,children:[y.isPending?e.jsx("div",{className:"w-4 h-4 animate-spin border-2 border-white border-t-transparent rounded-full mr-2"}):e.jsx(A,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]})})]})}export{Xe as default};
