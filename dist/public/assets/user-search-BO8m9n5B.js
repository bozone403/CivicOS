import{j as e}from"./ui-CDUWW_Ri.js";import{r as n}from"./vendor-1XCZ5AD1.js";import{z as de,u as oe,p as xe,q as me,K as P,r as K,g,h as q,i as U,l as he,n as D,j as f,I as H,B as d,L as C,v as j,al as je,U as ue,P as pe,D as ve,a as ge,b as fe,c as Ne,W as Y,X as _,Y as X,S as F,M as W,R as Z,Z as J,y as N,am as ye}from"./index-B1N5ipvw.js";import{T as be,a as we,b as ee,c as se}from"./tabs-DCXTq-v-.js";import{S as R,a as k,b as I,c as M,d as i}from"./select-CCEMg9Lb.js";import{T as Se}from"./trending-up-SM76QbfH.js";import{B as ae,G as Ce}from"./graduation-cap-NmnKTkJs.js";import{F as Fe}from"./flag-BdakioHr.js";import{T as ie}from"./trophy-G1M_LVhk.js";import{C as Te}from"./calendar-Cb_hvSC6.js";import"./index-q7PMzjPi.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=de("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function Ae(){var Q;oe();const{toast:y}=xe(),{user:o}=me(),[b,te]=n.useState(""),[l,V]=n.useState(""),[t,E]=n.useState({}),[z,re]=n.useState(!1),[a,w]=n.useState(null),[T,ce]=n.useState("search"),u=n.useRef();n.useEffect(()=>(u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{V(b)},500),()=>{u.current&&clearTimeout(u.current)}),[b]);const{data:c,isLoading:L}=P({queryKey:["user-search",l,t],queryFn:async()=>{if(!l||l.length<2)return{users:[],total:0,query:"",limit:20,offset:0};const s=new URLSearchParams({q:l,limit:"20",...Object.fromEntries(Object.entries(t).filter(([v,h])=>h!==void 0&&h!==""))});return await N(`/api/users/search?${s}`,"GET")},enabled:!!l&&l.length>=2}),{data:x}=P({queryKey:["popular-users"],queryFn:async()=>(await N("/api/users/popular","GET")).users||[],enabled:T==="discover"}),{data:m}=P({queryKey:["recent-activity-users"],queryFn:async()=>(await N("/api/users/recent-activity","GET")).users||[],enabled:T==="discover"}),B=K({mutationFn:async s=>N("/api/social/friends","POST",{friendId:s,action:"send"}),onSuccess:()=>{y({title:"Friend Request Sent",description:"Your friend request has been sent."})},onError:s=>{y({title:"Request Failed",description:s.message||"Failed to send friend request.",variant:"destructive"})}}),O=K({mutationFn:async s=>N("/api/social/messages","POST",{recipientId:s,content:"Hello! I'd like to connect with you on CivicOS."}),onSuccess:()=>{y({title:"Message Sent",description:"Your message has been sent."})},onError:s=>{y({title:"Message Failed",description:s.message||"Failed to send message.",variant:"destructive"})}}),ne=s=>{s.preventDefault(),V(b)},p=(s,r)=>{E(v=>({...v,[s]:r}))},le=()=>{E({})},S=s=>s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.firstName?s.firstName:s.email?s.email.split("@")[0]:"Anonymous User",$=s=>{switch(s==null?void 0:s.toLowerCase()){case"champion":return"bg-purple-500";case"expert":return"bg-blue-500";case"advocate":return"bg-green-500";case"active":return"bg-yellow-500";default:return"bg-gray-500"}},G=s=>s>=90?"text-green-600":s>=70?"text-yellow-600":"text-red-600",A=({user:s,showActions:r=!0})=>{var v;return e.jsx(g,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>w(s),children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(Y,{className:"w-12 h-12",children:[e.jsx(_,{src:s.profileImageUrl}),e.jsx(X,{className:"bg-blue-600",children:(v=S(s)[0])==null?void 0:v.toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:S(s)}),s.isVerified&&e.jsxs(j,{variant:"secondary",children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),"Verified"]}),e.jsx(j,{className:`text-xs ${$(s.civicLevel||"")}`,children:s.civicLevel||"Registered"})]}),s.occupation&&e.jsxs("p",{className:"text-sm text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"}),s.occupation]}),s.city&&s.province&&e.jsxs("p",{className:"text-sm text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(W,{className:"w-3 h-3"}),s.city,", ",s.province]}),s.bio&&e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:s.bio}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[e.jsxs("span",{className:`flex items-center gap-1 ${G(s.trustScore||0)}`,children:[e.jsx(F,{className:"w-3 h-3"}),s.trustScore||0,"% trust"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"}),s.civicPoints||0," points"]}),s.createdAt&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3"}),new Date(s.createdAt).toLocaleDateString()]})]})]}),r&&(o==null?void 0:o.id)!==s.id&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(d,{size:"sm",variant:"outline",onClick:h=>{h.stopPropagation(),B.mutate(s.id)},children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Add"]}),e.jsxs(d,{size:"sm",variant:"ghost",onClick:h=>{h.stopPropagation(),O.mutate(s.id)},children:[e.jsx(J,{className:"w-3 h-3 mr-1"}),"Message"]})]})]})})})};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Find Civic Citizens"}),e.jsx("p",{className:"text-gray-600",children:"Discover and connect with engaged citizens in your community"})]}),e.jsxs(be,{value:T,onValueChange:ce,children:[e.jsxs(we,{className:"grid w-full grid-cols-2",children:[e.jsx(ee,{value:"search",children:"Search Users"}),e.jsx(ee,{value:"discover",children:"Discover"})]}),e.jsxs(se,{value:"search",className:"space-y-6",children:[e.jsxs(g,{children:[e.jsxs(q,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),"Search Users"]}),e.jsx(D,{children:"Find users by name, email, location, or interests"})]}),e.jsx(f,{children:e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(H,{placeholder:"Search by name, email, location, or interests...",value:b,onChange:s=>te(s.target.value),className:"w-full"})}),e.jsx(d,{type:"submit",disabled:L,children:L?"Searching...":"Search"}),e.jsxs(d,{type:"button",variant:"outline",onClick:()=>re(!z),children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Filters"]})]}),z&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location"}),e.jsx(H,{id:"location",placeholder:"City or Province",value:t.location||"",onChange:s=>p("location",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"civicLevel",children:"Civic Level"}),e.jsxs(R,{value:t.civicLevel||"",onValueChange:s=>p("civicLevel",s),children:[e.jsx(k,{children:e.jsx(I,{placeholder:"Any level"})}),e.jsxs(M,{children:[e.jsx(i,{value:"",children:"Any level"}),e.jsx(i,{value:"champion",children:"Champion"}),e.jsx(i,{value:"expert",children:"Expert"}),e.jsx(i,{value:"advocate",children:"Advocate"}),e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"registered",children:"Registered"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"verification",children:"Verification"}),e.jsxs(R,{value:t.verificationStatus||"",onValueChange:s=>p("verificationStatus",s),children:[e.jsx(k,{children:e.jsx(I,{placeholder:"Any status"})}),e.jsxs(M,{children:[e.jsx(i,{value:"",children:"Any status"}),e.jsx(i,{value:"verified",children:"Verified only"}),e.jsx(i,{value:"unverified",children:"Unverified only"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"sortBy",children:"Sort By"}),e.jsxs(R,{value:t.sortBy||"",onValueChange:s=>p("sortBy",s),children:[e.jsx(k,{children:e.jsx(I,{placeholder:"Relevance"})}),e.jsxs(M,{children:[e.jsx(i,{value:"relevance",children:"Relevance"}),e.jsx(i,{value:"trust_score",children:"Trust Score"}),e.jsx(i,{value:"civic_points",children:"Civic Points"}),e.jsx(i,{value:"recent",children:"Recently Active"})]})]})]})]}),Object.keys(t).some(s=>t[s])&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active filters:"}),Object.entries(t).map(([s,r])=>r&&e.jsxs(j,{variant:"secondary",className:"text-xs",children:[s,": ",r,e.jsx(je,{className:"w-3 h-3 ml-1 cursor-pointer",onClick:()=>p(s,"")})]},s)),e.jsx(d,{variant:"ghost",size:"sm",onClick:le,className:"text-xs",children:"Clear all"})]})]})})]}),l&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold",children:["Search Results",c&&e.jsxs("span",{className:"text-sm font-normal text-gray-600 ml-2",children:["(",c.total," users found)"]})]})}),L?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Searching users..."})]}):(c==null?void 0:c.users.length)===0?e.jsx(g,{children:e.jsxs(f,{className:"p-8 text-center",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No users found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search terms or filters to find more users."})]})}):e.jsx("div",{className:"grid gap-4",children:c==null?void 0:c.users.map(s=>e.jsx(A,{user:s},s.id))})]})]}),e.jsxs(se,{value:"discover",className:"space-y-6",children:[e.jsxs(g,{children:[e.jsxs(q,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"Popular Users"]}),e.jsx(D,{children:"Most engaged and trusted citizens on the platform"})]}),e.jsx(f,{children:(x==null?void 0:x.length)===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No popular users found"}):e.jsx("div",{className:"grid gap-4",children:x==null?void 0:x.map(s=>e.jsx(A,{user:s},s.id))})})]}),e.jsxs(g,{children:[e.jsxs(q,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Recently Active"]}),e.jsx(D,{children:"Users who have been active recently"})]}),e.jsx(f,{children:(m==null?void 0:m.length)===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No recent activity found"}):e.jsx("div",{className:"grid gap-4",children:m==null?void 0:m.map(s=>e.jsx(A,{user:s},s.id))})})]})]})]}),e.jsx(ve,{open:!!a,onOpenChange:()=>w(null),children:e.jsxs(ge,{className:"max-w-2xl",children:[e.jsx(fe,{children:e.jsx(Ne,{children:"User Profile"})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Y,{className:"w-16 h-16",children:[e.jsx(_,{src:a.profileImageUrl}),e.jsx(X,{className:"text-xl bg-blue-600",children:(Q=S(a)[0])==null?void 0:Q.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:S(a)}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.isVerified&&e.jsxs(j,{variant:"secondary",children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),"Verified"]}),e.jsx(j,{className:$(a.civicLevel||""),children:a.civicLevel||"Registered"})]})]})]}),a.bio&&e.jsx("p",{className:"text-gray-700",children:a.bio}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.occupation&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:a.occupation})]}),a.education&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:a.education})]}),a.city&&a.province&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:[a.city,", ",a.province]})]}),a.politicalAffiliation&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:a.politicalAffiliation})]})]}),a.interests&&a.interests.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Interests"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.interests.map((s,r)=>e.jsx(j,{variant:"secondary",children:s},r))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:`flex items-center gap-1 ${G(a.trustScore||0)}`,children:[e.jsx(F,{className:"w-4 h-4"}),a.trustScore||0,"% trust"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-4 h-4"}),a.civicPoints||0," points"]})]}),(o==null?void 0:o.id)!==a.id&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",onClick:()=>{B.mutate(a.id),w(null)},children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Add Friend"]}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>{O.mutate(a.id),w(null)},children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Message"]})]})]})]})]})})]})}function Be(){return e.jsx(ye,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Find CivicOS Users"}),e.jsx("p",{className:"text-gray-600",children:"Search for other civic-minded individuals to connect with and build your civic network."})]}),e.jsx(Ae,{})]})})})}export{Be as default};
