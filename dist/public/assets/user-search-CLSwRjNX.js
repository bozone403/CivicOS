import{j as e}from"./ui-B-8yHimL.js";import{r as u}from"./vendor-DRd396Ms.js";import{q,r as F,u as P,J as A,h as i,i as j,j as f,m as p,k as n,I as k,B as l,R as L,W as R,X as T,G as g,M as E,S as I,ah as U,x as v,al as $}from"./index-F6mC3WOe.js";import{A as B}from"./award-CXtWMhrA.js";import{E as M}from"./external-link-BMQgINbl.js";function Q(){const[a,N]=u.useState(""),[d,o]=u.useState(!1),{toast:r}=q(),{isAuthenticated:m}=F(),[,y]=P(),{data:t,isLoading:x,refetch:b}=A({queryKey:["user-search",a,m],queryFn:async()=>!a.trim()||a.length<2?{users:[],total:0,query:a,limit:20,offset:0}:await v(`/api/social/users/search?q=${encodeURIComponent(a)}`,"GET"),enabled:!1,staleTime:5*60*1e3}),h=async()=>{if(!a.trim()||a.length<2){r({title:"Search Error",description:"Please enter at least 2 characters to search",variant:"destructive"});return}o(!0);try{await b()}catch{r({title:"Search Failed",description:"Failed to search for users. Please try again.",variant:"destructive"})}finally{o(!1)}},S=async(s,c)=>{if(!m){r({title:"Authentication Required",description:"Please log in to add friends.",variant:"destructive"});return}try{await v("/api/friends/request","POST",{friendId:s}),r({title:"Friend Request Sent",description:`Friend request sent to ${c}`})}catch{r({title:"Request Failed",description:"Failed to send friend request. Please try again.",variant:"destructive"})}},w=s=>{switch(s.toLowerCase()){case"champion":return"bg-purple-500";case"expert":return"bg-blue-500";case"advocate":return"bg-green-500";case"active":return"bg-yellow-500";default:return"bg-gray-500"}},C=s=>s>=90?"text-green-600":s>=70?"text-yellow-600":"text-red-600";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i,{children:[e.jsx(j,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5"}),"Search Users"]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{placeholder:"Search by name, email, or location...",value:a,onChange:s=>N(s.target.value),onKeyPress:s=>s.key==="Enter"&&h(),className:"flex-1"}),e.jsx(l,{onClick:h,disabled:d||!a.trim(),children:d?"Searching...":"Search"})]})})]}),t&&t.users.length>0&&e.jsxs(i,{children:[e.jsx(j,{children:e.jsxs(f,{children:["Found ",t.total," user",t.total!==1?"s":""]})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:t.users.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(L,{className:"h-12 w-12",children:[e.jsx(R,{src:s.avatar}),e.jsx(T,{children:s.name.split(" ").map(c=>c[0]).join("").toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsx(g,{className:w(s.civicLevel),children:s.civicLevel}),e.jsxs(g,{variant:"outline",className:"text-xs",children:["ID: ",s.id]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-4 w-4"}),s.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(B,{className:"h-4 w-4"}),s.civicPoints," points"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:`h-4 w-4 ${C(s.trustScore)}`}),"Trust: ",s.trustScore,"%"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Member since ",s.memberSince]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:()=>y(`/profile/${s.id}`),size:"sm",variant:"outline",className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),"View Profile"]}),e.jsxs(l,{onClick:()=>S(s.id,s.name),size:"sm",className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Add Friend"]})]})]},s.id))})})]}),t&&t.users.length===0&&a&&!x&&e.jsx(i,{children:e.jsxs(n,{className:"text-center py-8",children:[e.jsx(p,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No users found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try searching with different terms or check your spelling."})]})}),x&&e.jsx(i,{children:e.jsxs(n,{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Searching for users..."})]})})]})}function J(){return e.jsx($,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Find CivicOS Users"}),e.jsx("p",{className:"text-gray-600",children:"Search for other civic-minded individuals to connect with and build your civic network."})]}),e.jsx(Q,{})]})})})}export{J as default};
