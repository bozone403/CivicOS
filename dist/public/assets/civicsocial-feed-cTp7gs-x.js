import{j as e}from"./ui-CDUWW_Ri.js";import{r as a}from"./vendor-1XCZ5AD1.js";import{z as oe,q as ce,p as de,E as ue,K as me,r as c,B as i,R as he,D as xe,a as pe,b as je,c as ve,L as F,$ as ye,a4 as ge,M as fe,an as B,a5 as Se,y as r,ao as Ne,l as be,I as Pe}from"./index-MPP4tdMH.js";import{S as v,a as y,b as g,c as f,d as t}from"./select-BYLf0bNl.js";import{C as S,a as Ce,b as we,c as Te,d,e as ke,f as Fe,g as Le}from"./CivicSocialCard-BH2xIoJ4.js";import{P as L}from"./plus-uKj7XLH8.js";import{T as qe}from"./trash-2-f9t1iTCp.js";import{T as Me}from"./tag-ByD_HZPo.js";import{C as Ve}from"./camera-mRcjEgWB.js";import{T as Ie}from"./trending-up-hihxotdn.js";import"./index-q7PMzjPi.js";import"./bookmark-olO1E-76.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function Xe(){const{user:Ee,isAuthenticated:Qe}=ce(),{toast:u}=de(),o=ue(),[D,l]=a.useState(!1),[q,Re]=a.useState("all"),[N,A]=a.useState("all"),[m,K]=a.useState(""),[b,U]=a.useState("latest"),[h,M]=a.useState(""),[V,I]=a.useState("post"),[O,E]=a.useState("public"),[z,$]=a.useState([]),[H,W]=a.useState(""),[Y,_]=a.useState(""),[Be,P]=a.useState(null),[x,C]=a.useState(null),{data:w,isLoading:T,error:G,refetch:Q}=me({queryKey:["socialFeed",q,N,b,m],queryFn:async()=>{const s=new URLSearchParams({tab:q,visibility:N,sort:b,...m&&{q:m}});return(await r(`/api/social/feed?${s}`)).feed||[]},staleTime:3e4}),k=c({mutationFn:async s=>await r("/api/social/posts","POST",s),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]}),l(!1),le(),u({title:"Post created!",description:"Your post has been shared successfully."})},onError:s=>{u({title:"Error creating post",description:s.message||"Failed to create post. Please try again.",variant:"destructive"})}}),J=c({mutationFn:async s=>await r(`/api/social/posts/${s}/like`,"POST"),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]})}});c({mutationFn:async({postId:s,content:n})=>await r(`/api/social/posts/${s}/comments`,"POST",{content:n}),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]})}});const X=c({mutationFn:async s=>await r(`/api/social/posts/${s}/share`,"POST"),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]}),u({title:"Post shared!",description:"Your post has been shared successfully."})}}),Z=c({mutationFn:async s=>await r(`/api/social/posts/${s}/bookmark`,"POST"),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]})}}),ee=async s=>{if(s.preventDefault(),!h.trim())return;const n={content:h,type:V,visibility:O,tags:z,location:H,mood:Y,...x&&{imageUrl:x}};k.mutate(n)},se=s=>{J.mutate(s)},te=s=>{u({title:"Comment feature",description:"Comment functionality coming soon!"})},ae=s=>{X.mutate(s)},ie=s=>{Z.mutate(s)},ne=s=>{var R;const n=(R=s.target.files)==null?void 0:R[0];n&&(P(n),C(URL.createObjectURL(n)))},le=()=>{M(""),I("post"),E("public"),$([]),W(""),_(""),P(null),C(null)},p=e.jsxs(e.Fragment,{children:[e.jsx(d,{title:"Quick Actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(i,{onClick:()=>l(!0),className:"w-full social-button-primary",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Create Post"]}),e.jsxs(i,{variant:"outline",className:"w-full",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Share Photo"]}),e.jsxs(i,{variant:"outline",className:"w-full",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Share Video"]})]})}),e.jsx(d,{title:"Trending Topics",children:e.jsx("div",{className:"space-y-2",children:["#CanadianPolitics","#CivicEngagement","#Democracy","#VotingRights"].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50 hover:bg-muted transition-colors cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium",children:s}),e.jsx(Ie,{className:"w-4 h-4 text-muted-foreground"})]},s))})}),e.jsx(d,{title:"Online Friends",children:e.jsx("div",{className:"space-y-2",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-md hover:bg-muted transition-colors cursor-pointer",children:[e.jsx("div",{className:"social-avatar-online w-8 h-8",children:e.jsxs("div",{className:"w-full h-full rounded-full bg-social-primary flex items-center justify-center text-white text-xs font-medium",children:["U",s]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium truncate",children:["User ",s]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Online"})]})]},s))})})]}),j=e.jsx(Le,{title:"CivicSocial Feed",subtitle:"Stay connected with your civic community",actions:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Q(),disabled:T,children:T?e.jsx(B,{className:"w-4 h-4 animate-spin"}):e.jsx(Oe,{className:"w-4 h-4"})}),e.jsxs(i,{onClick:()=>l(!0),className:"social-button-primary",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"New Post"]})]})}),re=e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 p-4 bg-card border border-border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Pe,{placeholder:"Search posts...",value:m,onChange:s=>K(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{value:N,onValueChange:s=>A(s),children:[e.jsx(y,{className:"w-32",children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(t,{value:"all",children:"All Posts"}),e.jsx(t,{value:"public",children:"Public"}),e.jsx(t,{value:"friends",children:"Friends"}),e.jsx(t,{value:"private",children:"Private"})]})]}),e.jsxs(v,{value:b,onValueChange:s=>U(s),children:[e.jsx(y,{className:"w-32",children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(t,{value:"latest",children:"Latest"}),e.jsx(t,{value:"popular",children:"Popular"}),e.jsx(t,{value:"trending",children:"Trending"})]})]})]})]});return T?e.jsx(S,{header:j,sidebar:p,children:e.jsx(Ce,{title:"Loading your feed...",description:"We're gathering the latest posts from your civic community."})}):G?e.jsx(S,{header:j,sidebar:p,children:e.jsx(we,{title:"Failed to load feed",description:"We couldn't load your social feed. Please check your connection and try again.",retry:()=>Q()})}):!w||w.length===0?e.jsx(S,{header:j,sidebar:p,children:e.jsx(Te,{title:"No posts yet",description:"Be the first to share something with your civic community!",icon:e.jsx(he,{className:"w-8 h-8"}),action:e.jsxs(i,{onClick:()=>l(!0),className:"social-button-primary",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Create Your First Post"]})})}):e.jsxs(S,{header:j,sidebar:p,children:[e.jsx(d,{children:re}),e.jsx(d,{children:e.jsx(ke,{children:w.map(s=>e.jsx(Fe,{post:s,onLike:se,onComment:te,onShare:ae,onBookmark:ie},s.id))})}),e.jsx(xe,{open:D,onOpenChange:l,children:e.jsxs(pe,{className:"max-w-2xl",children:[e.jsx(je,{children:e.jsx(ve,{children:"Create a New Post"})}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"content",children:"What's on your mind?"}),e.jsx(ye,{id:"content",placeholder:"Share your thoughts with the civic community...",value:h,onChange:s=>M(s.target.value),className:"min-h-[120px]",required:!0})]}),x&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:x,alt:"Preview",className:"w-full rounded-lg max-h-64 object-cover"}),e.jsx(i,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{P(null),C(null)},children:e.jsx(qe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"type",children:"Post Type"}),e.jsxs(v,{value:V,onValueChange:s=>I(s),children:[e.jsx(y,{children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(t,{value:"post",children:"Post"}),e.jsx(t,{value:"share",children:"Share"}),e.jsx(t,{value:"poll",children:"Poll"}),e.jsx(t,{value:"event",children:"Event"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"visibility",children:"Visibility"}),e.jsxs(v,{value:O,onValueChange:s=>E(s),children:[e.jsx(y,{children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(t,{value:"public",children:"Public"}),e.jsx(t,{value:"friends",children:"Friends"}),e.jsx(t,{value:"private",children:"Private"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(i,{type:"button",variant:"outline",size:"sm",onClick:()=>{var s;return(s=document.getElementById("image-upload"))==null?void 0:s.click()},children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Add Image"]}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",onChange:ne,className:"hidden"}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Add Location"]}),e.jsxs(i,{type:"button",variant:"outline",size:"sm",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Add Tags"]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(i,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(i,{type:"submit",className:"social-button-primary",disabled:k.isPending||!h.trim(),children:[k.isPending?e.jsx(B,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]})})]})}export{Xe as default};
