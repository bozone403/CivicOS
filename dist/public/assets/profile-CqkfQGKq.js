import{j as e}from"./ui-B-8yHimL.js";import{r as K,u as Q,q as Z,J as R,B as n,h as d,k as m,D as J,P as X,a as _,b as S,d as ee,e as se,I as f,Q as ae,G as A,i as N,j as v,U as u,Z as ie,o as B,V as O,O as le,F as te,x as ce}from"./index-BeuhHH6b.js";import{r as l}from"./vendor-DRd396Ms.js";import{P as x}from"./progress-CYyvPjO9.js";import{T as ne}from"./trophy-BKIxYO10.js";function he(){var D,U,I,F;const{user:i,isAuthenticated:q,updateProfile:M}=K(),[o,$]=Q(),{toast:g}=Z(),h=l.useMemo(()=>o.split("/"),[o]),c=l.useMemo(()=>h[h.length-1],[h]),r=l.useMemo(()=>!c||c==="profile"||c===(i==null?void 0:i.id)||o==="/profile",[c,i==null?void 0:i.id,o]),j=l.useMemo(()=>r?i==null?void 0:i.id:c,[r,i==null?void 0:i.id,c]),{data:b,isLoading:G}=R({queryKey:["user-profile",j],queryFn:async()=>r?i:await ce(`/api/social/users/${j}`,"GET"),enabled:!!j}),s=l.useMemo(()=>b||i,[b,i]),[V,W]=l.useState(!1),[Y,p]=l.useState(!1),[y,w]=l.useState(""),[C,P]=l.useState(""),[k,L]=l.useState(""),[E,T]=l.useState("");l.useRef(null),l.useEffect(()=>{s&&(w(s.firstName||""),P(s.lastName||""),L(s.bio||""),T(s.profileImageUrl||""))},[s==null?void 0:s.id,s==null?void 0:s.firstName,s==null?void 0:s.lastName,s==null?void 0:s.bio,s==null?void 0:s.profileImageUrl]),l.useEffect(()=>{window.location.search.includes("welcome")&&W(!0)},[]);const z=async()=>{try{await M({firstName:y,lastName:C,bio:k,profileImageUrl:E}),p(!1)}catch{}};if(!q)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading your profile..."}),e.jsx("p",{className:"text-gray-600",children:"Please log in to view profiles."})]})});if(G)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading profile..."}),e.jsx("p",{className:"text-gray-600",children:"Fetching user information..."})]})});if(!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"User not found"}),e.jsx("p",{className:"text-gray-600",children:"The user you're looking for doesn't exist or has been removed."}),e.jsx(n,{onClick:()=>$("/dashboard"),className:"mt-4",children:"Go to Dashboard"})]})});if(V)return e.jsx(d,{className:"max-w-xl mx-auto mt-12 p-6 bg-yellow-50 border-yellow-400 text-center",children:e.jsxs(m,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to CivicOS Beta!"}),e.jsx("p",{className:"mb-4 text-gray-700",children:"Your feedback and participation are crucial! The more people who join, the faster we can improve and unlock full civic intelligence for everyone."}),e.jsx(n,{className:"mb-2",onClick:()=>{navigator.clipboard.writeText(window.location.origin),g({title:"Link copied!",description:"Share CivicOS with your friends and help us grow."})},children:"Invite Friends"}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Exposure is keyâ€”spread the word and help build a better civic future!"})]})});const{data:a}=R({queryKey:["/api/user/stats"]});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden mb-8",children:[e.jsx("div",{className:"h-48 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 relative",children:e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"})}),e.jsx("div",{className:"relative px-6 pb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-end space-y-4 sm:space-y-0 sm:space-x-6",children:[e.jsx("div",{className:"relative -mt-16",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white text-4xl font-bold border-4 border-white shadow-lg",children:s!=null&&s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):((D=s==null?void 0:s.firstName)==null?void 0:D[0])||((U=s==null?void 0:s.email)==null?void 0:U[0])||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s!=null&&s.firstName&&(s!=null&&s.lastName)?`${s.firstName} ${s.lastName}`:((I=s==null?void 0:s.email)==null?void 0:I.split("@")[0])||"User"}),r&&e.jsxs(J,{open:Y,onOpenChange:p,children:[e.jsx(X,{asChild:!0,children:e.jsx(n,{variant:"outline",size:"sm",children:"Edit Profile"})}),e.jsxs(_,{className:"max-w-md",children:[e.jsxs(S,{children:[e.jsx(ee,{children:"Edit Profile"}),e.jsx(se,{children:"Update your profile information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name"}),e.jsx(f,{value:y,onChange:t=>w(t.target.value),placeholder:"First name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name"}),e.jsx(f,{value:C,onChange:t=>P(t.target.value),placeholder:"Last name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bio"}),e.jsx(ae,{value:k,onChange:t=>L(t.target.value),placeholder:"Tell us about yourself...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Profile Picture URL"}),e.jsx(f,{value:E,onChange:t=>T(t.target.value),placeholder:"https://example.com/image.jpg"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx(n,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(n,{onClick:z,children:"Save Changes"})]})]})]})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:s==null?void 0:s.email}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(A,{variant:"outline",className:"text-xs",children:["User ID: ",s==null?void 0:s.id]}),r&&e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/profile/${s==null?void 0:s.id}`),g({title:"Profile URL Copied!",description:"Share this link with others to view your profile"})},children:"Copy Profile URL"})]}),e.jsx("p",{className:"text-gray-700",children:(s==null?void 0:s.bio)||"No bio yet. Click 'Edit Profile' to add one!"})]})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(d,{className:"bg-white shadow-sm",children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center space-x-2",children:[e.jsx(u,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Profile Stats"})]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Trust Score"}),e.jsxs(A,{variant:"secondary",children:[(a==null?void 0:a.trustScore)||"100.00","%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Civic Level"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ne,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.civicLevel)||1})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Civic Points"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ie,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.civicPoints)||0})]})]})]})]}),e.jsxs(d,{className:"md:col-span-2",children:[e.jsxs(N,{children:[e.jsx(v,{children:"Civic Engagement"}),e.jsx(B,{children:"Your participation in democratic processes"})]}),e.jsx(m,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Votes Cast"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.voteCount)||0})]}),e.jsx(x,{value:((a==null?void 0:a.voteCount)||0)*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Discussions"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.discussionCount)||0})]}),e.jsx(x,{value:((a==null?void 0:a.discussionCount)||0)*5,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm",children:"Petitions Signed"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.petitionCount)||0})]}),e.jsx(x,{value:((a==null?void 0:a.petitionCount)||0)*15,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm",children:"Representatives Contacted"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.contactCount)||0})]}),e.jsx(x,{value:((a==null?void 0:a.contactCount)||0)*20,className:"h-2"})]})]})})]}),e.jsxs(d,{className:"md:col-span-3",children:[e.jsxs(N,{children:[e.jsx(v,{children:"Recent Activity"}),e.jsx(B,{children:"Your latest civic engagement activities"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:(((F=a==null?void 0:a.recentActivity)==null?void 0:F.length)||0)>0?((a==null?void 0:a.recentActivity)||[]).map((t,H)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"h-8 w-8 bg-civic-blue rounded-full flex items-center justify-center",children:e.jsx(O,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.description}),e.jsx("p",{className:"text-sm text-gray-600",children:t.date})]})]},H)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(u,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Start engaging with civic activities to see your activity here!"})]})})})]})]})]})})}export{he as default};
