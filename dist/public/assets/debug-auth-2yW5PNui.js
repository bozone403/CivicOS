import{r as S,aj as r,j as e,g as a,h as u,i as n,w as C,k as l,B as o,z as E}from"./index-buf9avXS.js";import{r as c}from"./vendor-BzpAWY_6.js";import"./ui-7zmNL429.js";function _(){const{user:d,isAuthenticated:m,isLoading:g}=S(),[p,v]=c.useState({}),[h,x]=c.useState({}),[b,N]=c.useState(!1),t=localStorage.getItem("civicos-jwt");c.useEffect(()=>{v({token:t?`${t.substring(0,20)}...`:"None",tokenLength:(t==null?void 0:t.length)||0,apiUrl:r.apiUrl,userAgent:navigator.userAgent,timestamp:new Date().toISOString(),localStorage:{hasToken:!!t,tokenKey:"civicos-jwt",allKeys:Object.keys(localStorage)}})},[t]);const f=async()=>{N(!0);const i={};try{try{const s=await fetch(`${r.apiUrl}/api/auth/env-check`);i.backendReachable={status:s.ok,statusText:s.statusText,data:await s.json()}}catch(s){i.backendReachable={status:!1,error:s instanceof Error?s.message:String(s)}}try{const s=await fetch(`${r.apiUrl}/api/auth/debug-jwt`);i.jwtSecret={status:s.ok,statusText:s.statusText,data:await s.json()}}catch(s){i.jwtSecret={status:!1,error:s instanceof Error?s.message:String(s)}}if(t)try{const s=await E("/api/auth/user","GET");i.tokenValidation={status:!0,data:s}}catch(s){i.tokenValidation={status:!1,error:s instanceof Error?s.message:String(s)}}else i.tokenValidation={status:!1,error:"No token to test"};try{const s=await fetch(`${r.apiUrl}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"test@example.com",password:"wrongpassword"})});i.loginEndpoint={status:s.ok,statusCode:s.status,statusText:s.statusText}}catch(s){i.loginEndpoint={status:!1,error:s instanceof Error?s.message:String(s)}}}catch(s){i.generalError=s instanceof Error?s.message:String(s)}x(i),N(!1)},j=()=>{localStorage.removeItem("civicos-jwt"),window.location.reload()},D=()=>{window.location.href="/auth"},k=()=>{window.location.reload()};return e.jsxDEV("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxDEV("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxDEV(a,{children:[e.jsxDEV(u,{children:e.jsxDEV(n,{className:"flex items-center gap-2",children:["üîç Authentication Debug Panel",e.jsxDEV(C,{variant:m?"default":"destructive",children:m?"Authenticated":"Not Authenticated"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:137,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:135,columnNumber:13},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:134,columnNumber:11},this),e.jsxDEV(l,{className:"space-y-4",children:[e.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"font-semibold mb-2",children:"Authentication State"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:145,columnNumber:17},this),e.jsxDEV("div",{className:"space-y-2 text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Loading:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:147,columnNumber:24},this)," ",g?"Yes":"No"]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:147,columnNumber:19},this),e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Authenticated:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:148,columnNumber:24},this)," ",m?"Yes":"No"]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:148,columnNumber:19},this),e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Token exists:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:149,columnNumber:24},this)," ",t?"Yes":"No"]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:149,columnNumber:19},this),e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"User:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:150,columnNumber:24},this)," ",d?`${d.firstName} ${d.lastName}`:"None"]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:150,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:146,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:144,columnNumber:15},this),e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:"font-semibold mb-2",children:"Configuration"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:155,columnNumber:18},this),e.jsxDEV("div",{className:"space-y-2 text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"API URL:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:157,columnNumber:25},this)," ",r.apiUrl]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:157,columnNumber:20},this),e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Environment:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:158,columnNumber:25},this)," ",r.environment]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:158,columnNumber:20},this),e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Version:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:159,columnNumber:25},this)," ",r.version]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:159,columnNumber:20},this),e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Token Length:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:160,columnNumber:25},this)," ",(t==null?void 0:t.length)||0]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:160,columnNumber:20},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:156,columnNumber:18},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:154,columnNumber:30},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:143,columnNumber:13},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(o,{onClick:f,disabled:b,children:b?"Running Tests...":"Run Diagnostic Tests"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:166,columnNumber:16},this),e.jsxDEV(o,{onClick:j,variant:"outline",children:"Clear Token"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:169,columnNumber:16},this),e.jsxDEV(o,{onClick:D,variant:"outline",children:"Go to Auth"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:172,columnNumber:16},this),e.jsxDEV(o,{onClick:k,variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Force Refresh"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:175,columnNumber:16},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:165,columnNumber:26},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:142,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:133,columnNumber:9},this),e.jsxDEV(a,{children:[e.jsxDEV(u,{children:e.jsxDEV(n,{children:"Debug Information"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:184,columnNumber:13},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:183,columnNumber:11},this),e.jsxDEV(l,{children:e.jsxDEV("pre",{className:"text-xs bg-gray-100 p-4 rounded overflow-auto max-h-64",children:JSON.stringify(p,null,2)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:187,columnNumber:13},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:186,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:182,columnNumber:9},this),Object.keys(h).length>0&&e.jsxDEV(a,{children:[e.jsxDEV(u,{children:e.jsxDEV(n,{children:"Test Results"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:196,columnNumber:15},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:195,columnNumber:13},this),e.jsxDEV(l,{children:e.jsxDEV("div",{className:"space-y-4",children:Object.entries(h).map(([i,s])=>e.jsxDEV("div",{className:"border rounded p-3",children:[e.jsxDEV("h4",{className:"font-semibold mb-2 capitalize",children:i.replace(/([A-Z])/g," $1")},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:202,columnNumber:21},this),e.jsxDEV("div",{className:"text-sm",children:[e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Status:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:204,columnNumber:28},this)," ",s.status?"‚úÖ Pass":"‚ùå Fail"]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:204,columnNumber:23},this),s.error&&e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Error:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:205,columnNumber:45},this)," ",s.error]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:205,columnNumber:40},this),s.statusCode&&e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Status Code:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:206,columnNumber:50},this)," ",s.statusCode]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:206,columnNumber:45},this),s.data&&e.jsxDEV("div",{children:[e.jsxDEV("strong",{children:"Data:"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:209,columnNumber:27},this),e.jsxDEV("pre",{className:"text-xs bg-gray-100 p-2 rounded mt-1 overflow-auto",children:JSON.stringify(s.data,null,2)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:210,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:208,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:203,columnNumber:21},this)]},i,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:201,columnNumber:19},this))},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:199,columnNumber:15},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:198,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:194,columnNumber:11},this),e.jsxDEV(a,{children:[e.jsxDEV(u,{children:e.jsxDEV(n,{children:"Authentication Debug Logs"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:225,columnNumber:13},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:224,columnNumber:11},this),e.jsxDEV(l,{children:e.jsxDEV("div",{className:"max-h-64 overflow-y-auto",children:window.authDebug?e.jsxDEV("div",{className:"space-y-2",children:window.authDebug.map((i,s)=>e.jsxDEV("div",{className:"text-xs border-b pb-1",children:[e.jsxDEV("div",{className:"text-gray-500",children:i.timestamp},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:233,columnNumber:23},this),e.jsxDEV("div",{className:"text-blue-600",children:i.message},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:234,columnNumber:23},this),i.data&&e.jsxDEV("pre",{className:"text-xs bg-gray-100 p-1 rounded mt-1",children:JSON.stringify(i.data,null,2)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:236,columnNumber:25},this)]},s,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:232,columnNumber:21},this))},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:230,columnNumber:17},this):e.jsxDEV("div",{className:"text-gray-500",children:"No debug logs available"},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:244,columnNumber:17},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:228,columnNumber:13},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:227,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:223,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:132,columnNumber:7},this)},void 0,!1,{fileName:"/Users/jordan/Desktop/CivicOsSuite_3/client/src/pages/debug-auth.tsx",lineNumber:131,columnNumber:5},this)}export{_ as default};
