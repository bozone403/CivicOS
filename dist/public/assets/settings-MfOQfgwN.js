import{j as e}from"./ui-CDUWW_Ri.js";import{z as Q,q as K,E as W,p as X,r as E,g as m,h,i as x,n as p,j as u,X as Z,Y as $,Z as _,B as y,S as ee,L as n,I as c,J as se,a5 as R,t as ae,o as ie,G as te,y as V}from"./index-DZ2pIZMx.js";import{S as l}from"./switch-CRLbEF-q.js";import{A as z,a as B}from"./alert-DEBcSkuJ.js";import{r as d}from"./vendor-1XCZ5AD1.js";import{C as re}from"./camera-CD1KYTaN.js";import{L as ne}from"./lock-DIF2I2xG.js";import{S as ce}from"./smartphone-BgEF_zGR.js";import{G as le}from"./globe-vxsd2IzM.js";import"./index-q7PMzjPi.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=Q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function Ne(){var D;const{user:i}=K(),G=W(),{toast:j}=X(),[f,w]=d.useState({email:!0,push:!1,sms:!1,bills:!0,elections:!0,petitions:!1}),[P,b]=d.useState({publicProfile:!1,showVotes:!1,showLocation:!0}),[t,v]=d.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[A,g]=d.useState(""),[q,C]=d.useState(!1),[S,L]=d.useState(null),[Y,M]=d.useState(null),U=d.useRef(null);if(!i)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Please log in to view your settings."});const N=E({mutationFn:async s=>await V("/api/auth/change-password","POST",s),onSuccess:()=>{v({currentPassword:"",newPassword:"",confirmPassword:""}),g(""),C(!0),j({title:"Password Changed",description:"Your password has been updated successfully"}),setTimeout(()=>C(!1),3e3)},onError:s=>{g(s.message||"Failed to change password"),C(!1)}}),k=E({mutationFn:async s=>i?V("/api/users/profile","PUT",s):Promise.reject("No user"),onSuccess:()=>{G.invalidateQueries({queryKey:["/api/auth/user"]}),j({title:"Profile updated!",description:"Your changes have been saved."})}}),H=s=>{if(s.preventDefault(),g(""),!t.currentPassword||!t.newPassword||!t.confirmPassword){g("All password fields are required");return}if(t.newPassword!==t.confirmPassword){g("New passwords do not match");return}if(t.newPassword.length<6){g("New password must be at least 6 characters");return}N.mutate({currentPassword:t.currentPassword,newPassword:t.newPassword})},F=E({mutationFn:async s=>{const a=new FormData;a.append("profileImage",s);const o=localStorage.getItem("civicos-jwt"),r=await fetch("/api/auth/upload-profile-picture",{method:"POST",headers:o?{Authorization:`Bearer ${o}`}:void 0,body:a,credentials:"include"});if(!r.ok){const I=await r.text();throw new Error(I||"Failed to upload profile picture")}return await r.json()},onSuccess:()=>{j({title:"Profile Picture Updated",description:"Your profile picture has been updated successfully"}),L(null),M(null),window.location.reload()},onError:s=>{j({title:"Upload Failed",description:s.message||"Failed to upload profile picture",variant:"destructive"})}}),O=s=>{var o;const a=(o=s.target.files)==null?void 0:o[0];if(a){if(a.size>5*1024*1024){j({title:"File Too Large",description:"Please select an image smaller than 5MB",variant:"destructive"});return}if(!a.type.startsWith("image/")){j({title:"Invalid File Type",description:"Please select an image file",variant:"destructive"});return}L(a);const r=new FileReader;r.onload=I=>{var T;M((T=I.target)==null?void 0:T.result)},r.readAsDataURL(a)}},J=()=>{S&&F.mutate(S)};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account preferences and privacy settings"})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Profile Picture"})]}),e.jsx(p,{children:"Update your profile picture"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs(Z,{className:"w-24 h-24",children:[e.jsx($,{src:Y||(i==null?void 0:i.profileImageUrl)}),e.jsx(_,{className:"text-2xl",children:typeof(i==null?void 0:i.firstName)=="string"?(D=i==null?void 0:i.firstName)==null?void 0:D[0]:"U"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:U,type:"file",accept:"image/*",onChange:O,className:"hidden"}),e.jsxs(y,{onClick:()=>{var s;return(s=U.current)==null?void 0:s.click()},variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Choose New Picture"})]}),S&&e.jsx(y,{onClick:J,disabled:F.isPending,className:"w-full",children:F.isPending?"Uploading...":"Save Profile Picture"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload a JPG, PNG, or GIF. Max file size: 5MB"})]})]})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Account Information"})]}),e.jsx(p,{children:"Update your personal information"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("form",{onSubmit:s=>{var a,o,r;s.preventDefault(),k.mutate({firstName:(a=s.target.firstName)==null?void 0:a.value,lastName:(o=s.target.lastName)==null?void 0:o.value,email:(r=s.target.email)==null?void 0:r.value})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"profileFirstName",children:"First Name"}),e.jsx(c,{id:"profileFirstName",name:"firstName",defaultValue:(i==null?void 0:i.firstName)||"",placeholder:"Enter your first name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"profileLastName",children:"Last Name"}),e.jsx(c,{id:"profileLastName",name:"lastName",defaultValue:(i==null?void 0:i.lastName)||"",placeholder:"Enter your last name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"profileEmail",children:"Email Address"}),e.jsx(c,{id:"profileEmail",name:"email",type:"email",defaultValue:(i==null?void 0:i.email)||"",placeholder:"Enter your email",autoComplete:"username"})]}),e.jsx(y,{type:"submit",disabled:k.isPending,children:k.isPending?"Saving...":"Save Changes"})]})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Password Security"})]}),e.jsx(p,{children:"Change your account password"})]}),e.jsx(u,{children:e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[A&&e.jsx(z,{variant:"destructive",children:e.jsx(B,{children:A})}),q&&e.jsxs(z,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx(B,{children:"Password changed successfully!"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"currentPasswordInput",children:"Current Password"}),e.jsx(c,{id:"currentPasswordInput",type:"password",value:t.currentPassword,onChange:s=>v(a=>({...a,currentPassword:s.target.value})),placeholder:"Enter current password",disabled:N.isPending,autoComplete:"current-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"newPasswordInput",children:"New Password"}),e.jsx(c,{id:"newPasswordInput",type:"password",value:t.newPassword,onChange:s=>v(a=>({...a,newPassword:s.target.value})),placeholder:"Enter new password (min 6 characters)",disabled:N.isPending,autoComplete:"new-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"confirmPasswordInput",children:"Confirm New Password"}),e.jsx(c,{id:"confirmPasswordInput",type:"password",value:t.confirmPassword,onChange:s=>v(a=>({...a,confirmPassword:s.target.value})),placeholder:"Confirm new password",disabled:N.isPending,autoComplete:"new-password"})]}),e.jsx(y,{type:"submit",disabled:N.isPending,className:"bg-slate-800 hover:bg-slate-700",children:N.isPending?"Updating...":"Change Password"})]})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"h-5 w-5"}),e.jsx("span",{children:"Notification Preferences"})]}),e.jsx(p,{children:"Choose how you want to be notified about civic activities"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Notification Methods"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Email notifications"})]}),e.jsx(l,{checked:f.email,onCheckedChange:s=>w(a=>({...a,email:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Push notifications"})]}),e.jsx(l,{checked:f.push,onCheckedChange:s=>w(a=>({...a,push:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"SMS notifications"})]}),e.jsx(l,{checked:f.sms,onCheckedChange:s=>w(a=>({...a,sms:s}))})]})]})]}),e.jsx(ie,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Content Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"New bills and legislation"}),e.jsx(l,{checked:f.bills,onCheckedChange:s=>w(a=>({...a,bills:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Election updates"}),e.jsx(l,{checked:f.elections,onCheckedChange:s=>w(a=>({...a,elections:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Petition milestones"}),e.jsx(l,{checked:f.petitions,onCheckedChange:s=>w(a=>({...a,petitions:s}))})]})]})]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-5 w-5"}),e.jsx("span",{children:"Privacy Settings"})]}),e.jsx(p,{children:"Control what information is visible to others"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow others to see your civic engagement stats"})]}),e.jsx(l,{checked:P.publicProfile,onCheckedChange:s=>b(a=>({...a,publicProfile:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Show Voting History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Display your votes on bills and petitions"})]}),e.jsx(l,{checked:P.showVotes,onCheckedChange:s=>b(a=>({...a,showVotes:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Location-based Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Show relevant local politicians and issues"})]}),e.jsx(l,{checked:P.showLocation,onCheckedChange:s=>b(a=>({...a,showLocation:s}))})]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-5 w-5"}),e.jsx("span",{children:"Regional Preferences"})]}),e.jsx(p,{children:"Customize content for your location"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"provinceInput",children:"Province/Territory"}),e.jsx(c,{id:"provinceInput",placeholder:"Select your province",defaultValue:"Ontario"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"ridingInput",children:"Federal Riding"}),e.jsx(c,{id:"ridingInput",placeholder:"Enter your riding"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"municipalityInput",children:"Municipality"}),e.jsx(c,{id:"municipalityInput",placeholder:"Enter your city/town"})]})]})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(x,{className:"text-red-600",children:"Account Actions"}),e.jsx(p,{children:"Manage your account status"})]}),e.jsx(u,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-red-700",children:"Permanently delete your account and all associated data"})]}),e.jsx(y,{variant:"destructive",size:"sm",children:"Delete Account"})]})})]})]})})})}export{Ne as default};
