import{j as e}from"./ui-CDUWW_Ri.js";import{r as m}from"./vendor-1XCZ5AD1.js";import{z as X,q as Z,p as _,E as J,K as ee,r as c,g as u,j,R as se,U as ae,Q as te,h as T,i as F,v as x,D as ie,a as re,b as le,c as ne,X as E,Y as L,Z as M,I as ce,y as n,B as o,an as oe,M as de,ak as me,a2 as xe,_ as he}from"./index-cZ55YovK.js";import{T as ue,a as je,b as p,c as g}from"./tabs-DCkJ9Sbo.js";import{U as pe}from"./UnifiedSocialPost-KfU3WHdF.js";import{T as ge}from"./trending-up-DI2oEIM-.js";import{S as ye}from"./star-Bp73OUjD.js";import{C as ve}from"./clock-CdV_HHvu.js";import{G as Ne}from"./globe-orZ7ZwNp.js";import{S as fe}from"./square-pen-Cl_5Q3hM.js";import{T as be}from"./trash-2-DMeZkMWY.js";import{S as we}from"./share-33Fh02VO.js";import{B as ke}from"./bookmark-zk7sYEDV.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=X("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);function He(){var k;const{user:r}=Z(),{toast:t}=_(),l=J(),[y,q]=m.useState("all"),[Pe,A]=m.useState(!1),[Se,D]=m.useState({content:"",type:"post",visibility:"public",tags:[]}),[h,f]=m.useState(null),[Te,Fe]=m.useState(!1),[b,Ee]=m.useState({type:"all",visibility:"all",sortBy:"recent"}),{data:d,isLoading:$}=ee({queryKey:["social-posts",y,b],queryFn:async()=>{const s=new URLSearchParams({tab:y,...b});return(await n(`/api/social/posts?${s}`,"GET")).posts||[]}});c({mutationFn:async s=>{if(!r)throw new Error("Please log in to create posts");return n("/api/social/posts","POST",s)},onSuccess:()=>{t({title:"Post Created",description:"Your post has been published successfully."}),l.invalidateQueries({queryKey:["social-posts"]}),A(!1),D({content:"",type:"post",visibility:"public",tags:[]})},onError:s=>{console.error("Post creation error:",s),t({title:"Post Failed",description:s.message||"Failed to create post. Please check your connection and try again.",variant:"destructive"})}});const U=c({mutationFn:async({postId:s,action:a})=>n(`/api/social/posts/${s}/like`,"POST",{action:a}),onSuccess:()=>{l.invalidateQueries({queryKey:["social-posts"]})},onError:s=>{t({title:"Action Failed",description:s.message||"Failed to perform action.",variant:"destructive"})}}),B=c({mutationFn:async({postId:s,content:a})=>n(`/api/social/posts/${s}/comments`,"POST",{content:a}),onSuccess:()=>{l.invalidateQueries({queryKey:["social-posts"]}),t({title:"Comment Added",description:"Your comment has been posted."})},onError:s=>{t({title:"Comment Failed",description:s.message||"Failed to post comment.",variant:"destructive"})}}),K=c({mutationFn:async({postId:s,comment:a})=>n(`/api/social/posts/${s}/share`,"POST",{comment:a}),onSuccess:()=>{l.invalidateQueries({queryKey:["social-posts"]}),t({title:"Post Shared",description:"Your post has been shared successfully."})},onError:s=>{t({title:"Share Failed",description:s.message||"Failed to share post.",variant:"destructive"})}}),Q=c({mutationFn:async({postId:s,action:a})=>n(`/api/social/posts/${s}/bookmark`,"POST",{action:a}),onSuccess:()=>{l.invalidateQueries({queryKey:["social-posts"]})},onError:s=>{t({title:"Bookmark Failed",description:s.message||"Failed to bookmark post.",variant:"destructive"})}});c({mutationFn:async({postId:s,updates:a})=>n(`/api/social/posts/${s}`,"PUT",a),onSuccess:()=>{l.invalidateQueries({queryKey:["social-posts"]}),t({title:"Post Updated",description:"Your post has been updated successfully."})},onError:s=>{t({title:"Update Failed",description:s.message||"Failed to update post.",variant:"destructive"})}});const z=c({mutationFn:async s=>n(`/api/social/posts/${s}`,"DELETE"),onSuccess:()=>{l.invalidateQueries({queryKey:["social-posts"]}),t({title:"Post Deleted",description:"Your post has been deleted successfully."})},onError:s=>{t({title:"Delete Failed",description:s.message||"Failed to delete post.",variant:"destructive"})}}),I=s=>{U.mutate({postId:s.id,action:s.isLiked?"unlike":"like"})},Y=(s,a)=>{a.trim()&&B.mutate({postId:s,content:a})},H=s=>{K.mutate({postId:s.id})},O=s=>{Q.mutate({postId:s.id,action:s.isBookmarked?"unbookmark":"bookmark"})},v=s=>s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.firstName?s.firstName:s.email?s.email.split("@")[0]:"Anonymous User",R=s=>{switch(s==null?void 0:s.toLowerCase()){case"champion":return"bg-purple-500";case"expert":return"bg-blue-500";case"advocate":return"bg-green-500";case"active":return"bg-yellow-500";default:return"bg-gray-500"}},G=s=>{const a=new Date(s),i=Math.floor((new Date().getTime()-a.getTime())/1e3);return i<60?"just now":i<3600?`${Math.floor(i/60)}m ago`:i<86400?`${Math.floor(i/3600)}h ago`:i<2592e3?`${Math.floor(i/86400)}d ago`:a.toLocaleDateString()},w=({post:s})=>{var a,N,i,C,P,S;return e.jsx(u,{className:"mb-6 hover:shadow-md transition-shadow",children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(E,{className:"w-10 h-10",children:[e.jsx(L,{src:(a=s.user)==null?void 0:a.profileImageUrl}),e.jsx(M,{className:"bg-blue-600",children:(N=v(s.user)[0])==null?void 0:N.toUpperCase()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:v(s.user)}),((i=s.user)==null?void 0:i.isVerified)&&e.jsxs(x,{variant:"secondary",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),"Verified"]}),e.jsx(x,{className:`text-xs ${R(((C=s.user)==null?void 0:C.civicLevel)||"")}`,children:((P=s.user)==null?void 0:P.civicLevel)||"Registered"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ve,{className:"w-3 h-3"}),G(s.createdAt),s.visibility!=="public"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx(Ne,{className:"w-3 h-3"}),s.visibility]})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{variant:"ghost",size:"sm",children:e.jsx(oe,{className:"w-4 h-4"})}),((S=s.user)==null?void 0:S.id)===(r==null?void 0:r.id)&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border rounded-md shadow-lg z-10 min-w-[120px]",children:[e.jsxs(o,{variant:"ghost",size:"sm",className:"w-full justify-start",onClick:()=>{t({title:"Edit Feature",description:"Post editing will be available soon."})},children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(o,{variant:"ghost",size:"sm",className:"w-full justify-start text-red-600 hover:text-red-700",onClick:()=>{confirm("Are you sure you want to delete this post?")&&z.mutate(s.id)},children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s.content}),s.imageUrl&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:s.imageUrl,alt:"Post image",className:"rounded-lg max-w-full h-auto"})}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:s.tags.map((V,W)=>e.jsxs(x,{variant:"outline",className:"text-xs",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1"}),V]},W))}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-600",children:[s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(de,{className:"w-3 h-3"}),s.location]}),s.mood&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3"}),s.mood]})]})]}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[s.likesCount," likes"]}),e.jsxs("span",{children:[s.commentsCount," comments"]}),e.jsxs("span",{children:[s.sharesCount," shares"]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>I(s),className:s.isLiked?"text-red-600":"",children:[e.jsx(xe,{className:`w-4 h-4 mr-2 ${s.isLiked?"fill-current":""}`}),"Like"]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>f(s),children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Comment"]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>H(s),children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Share"]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>O(s),children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),s.isBookmarked?"Saved":"Save"]})]})]})})};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"CivicSocial Feed"}),e.jsx("p",{className:"text-gray-600",children:"Connect with fellow citizens and share your civic engagement"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"mb-6",children:e.jsx(pe,{placeholder:"What's on your mind?",onPostCreated:()=>{l.invalidateQueries({queryKey:["social-posts"]})}})}),e.jsxs(ue,{value:y,onValueChange:q,children:[e.jsxs(je,{className:"grid w-full grid-cols-4",children:[e.jsx(p,{value:"all",children:"All Posts"}),e.jsx(p,{value:"friends",children:"Friends"}),e.jsx(p,{value:"trending",children:"Trending"}),e.jsx(p,{value:"my-posts",children:"My Posts"})]}),e.jsx(g,{value:"all",className:"mt-6",children:$?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading posts..."})]}):(d==null?void 0:d.length)===0?e.jsx(u,{children:e.jsxs(j,{className:"p-8 text-center",children:[e.jsx(se,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-gray-600",children:"Be the first to share your civic thoughts and experiences!"})]})}):e.jsx("div",{children:d==null?void 0:d.map(s=>e.jsx(w,{post:s},s.id))})}),e.jsx(g,{value:"friends",className:"mt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Friends' Posts"}),e.jsx("p",{className:"text-gray-600",children:"Posts from your friends will appear here."})]})}),e.jsx(g,{value:"trending",className:"mt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Trending Posts"}),e.jsx("p",{className:"text-gray-600",children:"Most popular and engaging posts will appear here."})]})}),e.jsx(g,{value:"my-posts",className:"mt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"My Posts"}),e.jsx("p",{className:"text-gray-600",children:"Your posts will appear here."})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{children:[e.jsx(T,{children:e.jsx(F,{className:"text-lg",children:"Your Activity"})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Posts Created"}),e.jsx("span",{className:"text-sm font-medium",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Likes Given"}),e.jsx("span",{className:"text-sm font-medium",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Comments Made"}),e.jsx("span",{className:"text-sm font-medium",children:"0"})]})]})]}),e.jsxs(u,{children:[e.jsx(T,{children:e.jsx(F,{className:"text-lg",children:"Trending Topics"})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"#CivicEngagement"}),e.jsx(x,{variant:"secondary",children:"Hot"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"#LocalPolitics"}),e.jsx(x,{variant:"secondary",children:"Trending"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"#CommunityAction"}),e.jsx(x,{variant:"secondary",children:"New"})]})]})})]})]})]}),e.jsx(ie,{open:!!h,onOpenChange:()=>f(null),children:e.jsxs(re,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(ne,{children:"Post Details"})}),h&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{post:h}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Comments"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(E,{className:"w-8 h-8",children:[e.jsx(L,{src:r==null?void 0:r.profileImageUrl}),e.jsx(M,{className:"bg-blue-600 text-xs",children:(k=v(r)[0])==null?void 0:k.toUpperCase()})]}),e.jsx("div",{className:"flex-1",children:e.jsx(ce,{placeholder:"Write a comment...",onKeyPress:s=>{s.key==="Enter"&&s.currentTarget.value.trim()&&(Y(h.id,s.currentTarget.value),s.currentTarget.value="")}})})]}),e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No comments yet. Be the first to comment!"})]})]})]})]})})]})}export{He as default};
