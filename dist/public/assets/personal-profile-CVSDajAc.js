import{j as e}from"./ui-B-8yHimL.js";import{r as U}from"./vendor-DRd396Ms.js";import{c as Q,r as R,u as V,q as B,E as H,J as p,s as W,B as n,G as q,D as Z,P as J,a as X,b as _,d as z,e as S,Q as ee,h as N,i as u,j as f,U as F,k as g,Z as se,o as I,V as ae,O as v,F as te,R as ie,W as le,X as ce,Y as ne,_ as re,x as b}from"./index-BeuhHH6b.js";import{P as o}from"./progress-CYyvPjO9.js";import{P as de}from"./plus-p65hhI2O.js";import{T as oe}from"./trophy-BKIxYO10.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=Q("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);function fe(){var P,D,T;const{user:i,isAuthenticated:E}=R(),[A,y]=V(),{toast:m}=B(),M=H(),w=A.split("/"),r=w[w.length-1],l=!r||r==="profile"||r===(i==null?void 0:i.id),c=l?i==null?void 0:i.id:r,{data:Y,isLoading:O}=p({queryKey:["user-profile",c],queryFn:async()=>l?i:await b(`/api/social/users/${c}`,"GET"),enabled:!!c}),s=Y||i,[$,d]=U.useState(!1),[x,C]=U.useState(""),{data:h,isLoading:G}=p({queryKey:["user-posts",c],queryFn:async()=>(await b(`/api/social/posts?userId=${c}`,"GET")).posts||[],enabled:!!c}),j=W({mutationFn:async t=>await b("/api/social/posts","POST",{content:t}),onSuccess:()=>{C(""),d(!1),M.invalidateQueries({queryKey:["user-posts",c]}),m({title:"Post created!",description:"Your post has been shared with the community."})},onError:()=>{m({title:"Failed to create post",description:"Please try again later.",variant:"destructive"})}}),K=()=>{if(!x.trim()){m({title:"Empty post",description:"Please write something to share.",variant:"destructive"});return}j.mutate(x)};if(!E)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading your profile..."}),e.jsx("p",{className:"text-gray-600",children:"Please log in to view profiles."})]})});if(O)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading profile..."}),e.jsx("p",{className:"text-gray-600",children:"Fetching user information..."})]})});if(!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"User not found"}),e.jsx("p",{className:"text-gray-600",children:"The user you're looking for doesn't exist or has been removed."}),e.jsx(n,{onClick:()=>y("/dashboard"),className:"mt-4",children:"Go to Dashboard"})]})});const{data:a}=p({queryKey:["/api/user/stats"]});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden mb-8",children:[e.jsx("div",{className:"h-48 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 relative",children:e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"})}),e.jsx("div",{className:"relative px-6 pb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-end space-y-4 sm:space-y-0 sm:space-x-6",children:[e.jsx("div",{className:"relative -mt-16",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white text-4xl font-bold border-4 border-white shadow-lg",children:s!=null&&s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):((P=s==null?void 0:s.firstName)==null?void 0:P[0])||((D=s==null?void 0:s.email)==null?void 0:D[0])||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s!=null&&s.firstName&&(s!=null&&s.lastName)?`${s.firstName} ${s.lastName}`:((T=s==null?void 0:s.email)==null?void 0:T.split("@")[0])||"User"}),e.jsxs(q,{variant:"outline",className:"text-xs",children:["ID: ",s==null?void 0:s.id]})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:s==null?void 0:s.email}),e.jsx("p",{className:"text-gray-700",children:(s==null?void 0:s.bio)||"No bio yet. Visit settings to add one!"})]}),e.jsxs("div",{className:"flex gap-2",children:[l&&e.jsxs(Z,{open:$,onOpenChange:d,children:[e.jsx(J,{asChild:!0,children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Create Post"]})}),e.jsxs(X,{className:"max-w-md",children:[e.jsxs(_,{children:[e.jsx(z,{children:"Create a Post"}),e.jsx(S,{children:"Share something with the CivicOS community"})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(ee,{value:x,onChange:t=>C(t.target.value),placeholder:"What's on your mind?",rows:4})}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx(n,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(n,{onClick:K,disabled:j.isPending,children:j.isPending?"Posting...":"Post"})]})]})]}),e.jsx(n,{variant:"outline",onClick:()=>y("/settings"),children:"Settings"})]})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8",children:[e.jsxs(N,{className:"bg-white shadow-sm",children:[e.jsx(u,{className:"pb-3",children:e.jsxs(f,{className:"text-lg flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Profile Stats"})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Trust Score"}),e.jsxs(q,{variant:"secondary",children:[(a==null?void 0:a.trustScore)||"100.00","%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Civic Level"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(oe,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.civicLevel)||1})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Civic Points"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(se,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.civicPoints)||0})]})]})]})]}),e.jsxs(N,{className:"md:col-span-2",children:[e.jsxs(u,{children:[e.jsx(f,{children:"Civic Engagement"}),e.jsx(I,{children:"Your participation in democratic processes"})]}),e.jsx(g,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Votes Cast"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.voteCount)||0})]}),e.jsx(o,{value:((a==null?void 0:a.voteCount)||0)*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Discussions"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.discussionCount)||0})]}),e.jsx(o,{value:((a==null?void 0:a.discussionCount)||0)*5,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm",children:"Petitions Signed"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.petitionCount)||0})]}),e.jsx(o,{value:((a==null?void 0:a.petitionCount)||0)*15,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm",children:"Contacts Made"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.contactCount)||0})]}),e.jsx(o,{value:((a==null?void 0:a.contactCount)||0)*20,className:"h-2"})]})]})})]})]}),e.jsxs(N,{className:"bg-white shadow-sm",children:[e.jsxs(u,{children:[e.jsxs(f,{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:l?"Your Posts":`${(s==null?void 0:s.firstName)||"User"}'s Posts`})]}),e.jsx(I,{children:l?"Your recent activity and posts":"Recent posts and activity"})]}),e.jsx(g,{children:G?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading posts..."})]}):h&&h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(t=>{var k,L;return e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(ie,{className:"h-10 w-10",children:[e.jsx(le,{src:t.user.profileImageUrl}),e.jsx(ce,{children:((k=t.user.firstName)==null?void 0:k[0])||((L=t.user.lastName)==null?void 0:L[0])||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:"font-semibold",children:[t.user.firstName," ",t.user.lastName]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:t.content}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{children:t.likes})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:t.comments})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:t.shares})]})]})]})]})},t.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:l?"No posts yet":"No posts found"}),e.jsx("p",{className:"text-gray-600",children:l?"Start sharing your civic thoughts with the community!":"This user hasn't posted anything yet."}),l&&e.jsx(n,{onClick:()=>d(!0),className:"mt-4",children:"Create Your First Post"})]})})]})]})})}export{fe as default};
