import{j as e}from"./ui-B-8yHimL.js";import{r as Q,u as Z,q as J,J as I,B as c,h as d,k as o,D as M,P as X,a as _,b as S,d as ee,e as se,I as j,Q as ae,G as R,i as p,j as f,U as N,Z as ie,o as A,V as B,O as le,F as te,x as ce}from"./index-F6mC3WOe.js";import{r as l}from"./vendor-DRd396Ms.js";import{P as m}from"./progress-BbCcFjsa.js";import{T as ne}from"./trophy-C8C_5Gu3.js";function he(){var T,U,D,F;const{user:t,isAuthenticated:O,updateProfile:q}=Q(),[u,$]=Z(),{toast:v}=J(),g=u.split("/"),n=g[g.length-1],r=!n||n==="profile"||n===(t==null?void 0:t.id)||u==="/profile",x=r?t==null?void 0:t.id:n,{data:G,isLoading:V}=I({queryKey:["user-profile",x],queryFn:async()=>r?t:await ce(`/api/social/users/${x}`,"GET"),enabled:!!x}),s=G||t,[W,Y]=l.useState(!1),[z,h]=l.useState(!1),[b,y]=l.useState(""),[w,C]=l.useState(""),[P,k]=l.useState(""),[L,E]=l.useState("");l.useRef(null),l.useEffect(()=>{s&&(y(s.firstName||""),C(s.lastName||""),k(s.bio||""),E(s.profileImageUrl||""))},[s]),l.useEffect(()=>{window.location.search.includes("welcome")&&Y(!0)},[]);const H=async()=>{try{await q({firstName:b,lastName:w,bio:P,profileImageUrl:L}),h(!1)}catch{}};if(!O)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading your profile..."}),e.jsx("p",{className:"text-gray-600",children:"Please log in to view profiles."})]})});if(V)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading profile..."}),e.jsx("p",{className:"text-gray-600",children:"Fetching user information..."})]})});if(!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"User not found"}),e.jsx("p",{className:"text-gray-600",children:"The user you're looking for doesn't exist or has been removed."}),e.jsx(c,{onClick:()=>$("/dashboard"),className:"mt-4",children:"Go to Dashboard"})]})});if(W)return e.jsx(d,{className:"max-w-xl mx-auto mt-12 p-6 bg-yellow-50 border-yellow-400 text-center",children:e.jsxs(o,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to CivicOS Beta!"}),e.jsx("p",{className:"mb-4 text-gray-700",children:"Your feedback and participation are crucial! The more people who join, the faster we can improve and unlock full civic intelligence for everyone."}),e.jsx(c,{className:"mb-2",onClick:()=>{navigator.clipboard.writeText(window.location.origin),v({title:"Link copied!",description:"Share CivicOS with your friends and help us grow."})},children:"Invite Friends"}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Exposure is keyâ€”spread the word and help build a better civic future!"})]})});const{data:a}=I({queryKey:["/api/user/stats"]});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden mb-8",children:[e.jsx("div",{className:"h-48 bg-gradient-to-r from-blue-600 via-purple-600 to-blue-800 relative",children:e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20"})}),e.jsx("div",{className:"relative px-6 pb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-end space-y-4 sm:space-y-0 sm:space-x-6",children:[e.jsx("div",{className:"relative -mt-16",children:e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white text-4xl font-bold border-4 border-white shadow-lg",children:s!=null&&s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):((T=s==null?void 0:s.firstName)==null?void 0:T[0])||((U=s==null?void 0:s.email)==null?void 0:U[0])||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s!=null&&s.firstName&&(s!=null&&s.lastName)?`${s.firstName} ${s.lastName}`:((D=s==null?void 0:s.email)==null?void 0:D.split("@")[0])||"User"}),r&&e.jsxs(M,{open:z,onOpenChange:h,children:[e.jsx(X,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"sm",children:"Edit Profile"})}),e.jsxs(_,{className:"max-w-md",children:[e.jsxs(S,{children:[e.jsx(ee,{children:"Edit Profile"}),e.jsx(se,{children:"Update your profile information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name"}),e.jsx(j,{value:b,onChange:i=>y(i.target.value),placeholder:"First name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name"}),e.jsx(j,{value:w,onChange:i=>C(i.target.value),placeholder:"Last name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bio"}),e.jsx(ae,{value:P,onChange:i=>k(i.target.value),placeholder:"Tell us about yourself...",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Profile Picture URL"}),e.jsx(j,{value:L,onChange:i=>E(i.target.value),placeholder:"https://example.com/image.jpg"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx(c,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(c,{onClick:H,children:"Save Changes"})]})]})]})]}),e.jsx("p",{className:"text-gray-600 mb-2",children:s==null?void 0:s.email}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(R,{variant:"outline",className:"text-xs",children:["User ID: ",s==null?void 0:s.id]}),r&&e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/profile/${s==null?void 0:s.id}`),v({title:"Profile URL Copied!",description:"Share this link with others to view your profile"})},children:"Copy Profile URL"})]}),e.jsx("p",{className:"text-gray-700",children:(s==null?void 0:s.bio)||"No bio yet. Click 'Edit Profile' to add one!"})]})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(d,{className:"bg-white shadow-sm",children:[e.jsx(p,{className:"pb-3",children:e.jsxs(f,{className:"text-lg flex items-center space-x-2",children:[e.jsx(N,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:"Profile Stats"})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Trust Score"}),e.jsxs(R,{variant:"secondary",children:[(a==null?void 0:a.trustScore)||"100.00","%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Civic Level"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ne,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.civicLevel)||1})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Civic Points"}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ie,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.civicPoints)||0})]})]})]})]}),e.jsxs(d,{className:"md:col-span-2",children:[e.jsxs(p,{children:[e.jsx(f,{children:"Civic Engagement"}),e.jsx(A,{children:"Your participation in democratic processes"})]}),e.jsx(o,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm",children:"Votes Cast"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.voteCount)||0})]}),e.jsx(m,{value:((a==null?void 0:a.voteCount)||0)*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Discussions"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.discussionCount)||0})]}),e.jsx(m,{value:((a==null?void 0:a.discussionCount)||0)*5,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm",children:"Petitions Signed"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.petitionCount)||0})]}),e.jsx(m,{value:((a==null?void 0:a.petitionCount)||0)*15,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"h-4 w-4 text-orange-600"}),e.jsx("span",{className:"text-sm",children:"Representatives Contacted"})]}),e.jsx("span",{className:"font-medium",children:(a==null?void 0:a.contactCount)||0})]}),e.jsx(m,{value:((a==null?void 0:a.contactCount)||0)*20,className:"h-2"})]})]})})]}),e.jsxs(d,{className:"md:col-span-3",children:[e.jsxs(p,{children:[e.jsx(f,{children:"Recent Activity"}),e.jsx(A,{children:"Your latest civic engagement activities"})]}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:(((F=a==null?void 0:a.recentActivity)==null?void 0:F.length)||0)>0?((a==null?void 0:a.recentActivity)||[]).map((i,K)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"h-8 w-8 bg-civic-blue rounded-full flex items-center justify-center",children:e.jsx(B,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.description}),e.jsx("p",{className:"text-sm text-gray-600",children:i.date})]})]},K)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(N,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Start engaging with civic activities to see your activity here!"})]})})})]})]})]})})}export{he as default};
