import{j as e}from"./ui-CDUWW_Ri.js";import{r as m}from"./vendor-1XCZ5AD1.js";import{z as Z,q as _,p as ee,E as se,K as A,r as U,g as l,h as v,i as N,n as y,j as d,L as f,I as k,B as r,l as R,U as T,Q as ae,D as ie,a as te,b as re,c as ne,X as E,Y as P,Z as z,v as j,M as K,o as ce,J as M,ar as D,W as I,R as le,y as u,at as de,au as oe}from"./index-DCaV-fkU.js";import{T as he,a as xe,b,c as w}from"./tabs-DZpOfPUv.js";import{S as me,a as je,b as ue,c as ge,d as o}from"./select-BnNqaN6l.js";import{S as V}from"./star-DvECwkE9.js";import{U as Q}from"./user-check-V6twKj8V.js";import{C as O}from"./clock-CWkjjBLJ.js";import{E as pe}from"./external-link-CALQJ86J.js";import"./index-q7PMzjPi.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=Z("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function Ne(){var L;const{user:ye}=_(),{toast:h}=ee(),x=se(),[t,g]=m.useState({q:"",location:"",interests:"",civicLevel:""}),[B,Y]=m.useState("search"),[a,S]=m.useState(null),[G,H]=m.useState(!1),{data:n,isLoading:X}=A({queryKey:["users/search",t],queryFn:async()=>{const s=new URLSearchParams({q:t.q,location:t.location,interests:t.interests,civicLevel:t.civicLevel});return(await u(`/api/users/search?${s}`,"GET")).users||[]},enabled:t.q.length>0||t.location.length>0||t.civicLevel.length>0}),{data:C=[]}=A({queryKey:["users/suggestions"],queryFn:async()=>(await u("/api/users/suggestions","GET")).suggestions||[]}),$=U({mutationFn:async({friendId:s,action:i})=>u("/api/social/friends","POST",{friendId:s,action:i}),onSuccess:(s,i)=>{const J=i.action,W={send:"Friend request sent",accept:"Friend request accepted",reject:"Friend request rejected",remove:"Friend removed"}[J];h({title:"Success",description:W}),x.invalidateQueries({queryKey:["users/search"]}),x.invalidateQueries({queryKey:["users/suggestions"]}),x.invalidateQueries({queryKey:["social/friends"]})},onError:s=>{h({title:"Action Failed",description:s.message||"Failed to perform action.",variant:"destructive"})}});U({mutationFn:async({recipientId:s,content:i})=>u("/api/social/messages","POST",{recipientId:s,content:i}),onSuccess:()=>{h({title:"Message Sent",description:"Your message has been sent successfully."})},onError:s=>{h({title:"Message Failed",description:s.message||"Failed to send message.",variant:"destructive"})}});const p=()=>{x.invalidateQueries({queryKey:["users/search",t]})},c=(s,i)=>{$.mutate({friendId:s,action:i})},F=s=>{switch(s==null?void 0:s.toLowerCase()){case"champion":return"bg-purple-500";case"expert":return"bg-blue-500";case"advocate":return"bg-green-500";case"active":return"bg-yellow-500";default:return"bg-gray-500"}},q=({user:s})=>{var i;return e.jsx(l,{className:"mb-4 hover:shadow-md transition-shadow",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(E,{className:"w-12 h-12",children:[e.jsx(P,{src:s.profileImageUrl}),e.jsx(z,{className:"bg-blue-600",children:(i=s.displayName[0])==null?void 0:i.toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:s.displayName}),s.isVerified&&e.jsxs(j,{variant:"secondary",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Verified"]}),e.jsx(j,{className:`text-xs ${F(s.civicLevel||"")}`,children:s.civicLevel||"Registered"})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600 mb-1",children:[e.jsx(K,{className:"w-3 h-3"}),s.location]}),s.stats&&e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:[s.stats.posts," posts"]}),e.jsxs("span",{children:[s.stats.friends," friends"]}),e.jsxs("span",{children:[s.stats.activities," activities"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.friendship&&e.jsx(e.Fragment,{children:s.friendship.isFriend?e.jsxs(r,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Friends"]}):s.friendship.pendingRequest?e.jsxs(r,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),"Request Sent"]}):s.friendship.receivedRequest?e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>c(s.id,"accept"),children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Accept"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>c(s.id,"reject"),children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"Decline"]})]}):s.friendship.canSendRequest?e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>c(s.id,"send"),children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"Add Friend"]}):null}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>S(s),children:e.jsx(de,{className:"w-4 h-4"})})]})]})})})};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Find People"}),e.jsx("p",{className:"text-gray-600",children:"Connect with fellow citizens and build your civic network"})]}),e.jsxs(he,{value:B,onValueChange:Y,children:[e.jsxs(xe,{className:"grid w-full grid-cols-3",children:[e.jsx(b,{value:"search",children:"Search Users"}),e.jsx(b,{value:"suggestions",children:"Suggestions"}),e.jsx(b,{value:"recent",children:"Recent Activity"})]}),e.jsxs(w,{value:"search",className:"mt-6",children:[e.jsxs(l,{className:"mb-6",children:[e.jsxs(v,{children:[e.jsx(N,{children:"Search Users"}),e.jsx(y,{children:"Find people by name, location, or interests"})]}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(f,{htmlFor:"search-name",children:"Name or Email"}),e.jsx(k,{id:"search-name",placeholder:"Search by name or email...",value:t.q,onChange:s=>g(i=>({...i,q:s.target.value})),onKeyPress:s=>s.key==="Enter"&&p()})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"search-location",children:"Location"}),e.jsx(k,{id:"search-location",placeholder:"City, province, or riding...",value:t.location,onChange:s=>g(i=>({...i,location:s.target.value})),onKeyPress:s=>s.key==="Enter"&&p()})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"search-level",children:"Civic Level"}),e.jsxs(me,{value:t.civicLevel,onValueChange:s=>g(i=>({...i,civicLevel:s})),children:[e.jsx(je,{children:e.jsx(ue,{placeholder:"Any level"})}),e.jsxs(ge,{children:[e.jsx(o,{value:"",children:"Any level"}),e.jsx(o,{value:"Registered",children:"Registered"}),e.jsx(o,{value:"Active",children:"Active"}),e.jsx(o,{value:"Advocate",children:"Advocate"}),e.jsx(o,{value:"Expert",children:"Expert"}),e.jsx(o,{value:"Champion",children:"Champion"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(r,{onClick:p,className:"w-full",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Search"]})})]})})]}),X?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Searching users..."})]}):(n==null?void 0:n.length)===0&&(t.q||t.location||t.civicLevel)?e.jsx(l,{children:e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(T,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No users found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search criteria or browse suggestions instead."})]})}):(n==null?void 0:n.length)>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Search Results (",n.length,")"]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>H(!G),children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Filters"]})]}),n.map(s=>e.jsx(q,{user:s},s.id))]}):e.jsx(l,{children:e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(R,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Start searching"}),e.jsx("p",{className:"text-gray-600",children:"Enter a name, location, or civic level to find users."})]})})]}),e.jsx(w,{value:"suggestions",className:"mt-6",children:e.jsxs(l,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"People You May Know"}),e.jsx(y,{children:"Users with similar interests or location"})]}),e.jsx(d,{children:C.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No suggestions yet"}),e.jsx("p",{className:"text-gray-600",children:"Complete your profile to get personalized suggestions."})]}):e.jsx("div",{className:"space-y-4",children:C.map(s=>e.jsx(q,{user:s},s.id))})})]})}),e.jsx(w,{value:"recent",className:"mt-6",children:e.jsxs(l,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Recent Activity"}),e.jsx(y,{children:"Recent user activity and engagement"})]}),e.jsx(d,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No recent activity"}),e.jsx("p",{className:"text-gray-600",children:"Activity feed will appear here as users engage with the platform."})]})})]})})]}),e.jsx(ie,{open:!!a,onOpenChange:()=>S(null),children:e.jsxs(te,{className:"max-w-2xl",children:[e.jsx(re,{children:e.jsx(ne,{children:"User Profile"})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(E,{className:"w-16 h-16",children:[e.jsx(P,{src:a.profileImageUrl}),e.jsx(z,{className:"bg-blue-600 text-lg",children:(L=a.displayName[0])==null?void 0:L.toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:a.displayName}),a.isVerified&&e.jsxs(j,{variant:"secondary",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Verified"]}),e.jsx(j,{className:F(a.civicLevel||""),children:a.civicLevel||"Registered"})]}),a.location&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-600 mb-2",children:[e.jsx(K,{className:"w-4 h-4"}),a.location]}),a.stats&&e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[a.stats.posts," posts"]}),e.jsxs("span",{children:[a.stats.friends," friends"]}),e.jsxs("span",{children:[a.stats.activities," activities"]})]})]})]}),e.jsx(ce,{}),e.jsxs("div",{className:"flex gap-2",children:[a.friendship&&e.jsx(e.Fragment,{children:a.friendship.isFriend?e.jsxs(r,{variant:"outline",disabled:!0,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Friends"]}):a.friendship.pendingRequest?e.jsxs(r,{variant:"outline",disabled:!0,children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Request Sent"]}):a.friendship.receivedRequest?e.jsxs(e.Fragment,{children:[e.jsxs(r,{onClick:()=>c(a.id,"accept"),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Accept Request"]}),e.jsxs(r,{variant:"outline",onClick:()=>c(a.id,"reject"),children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Decline"]})]}):a.friendship.canSendRequest?e.jsxs(r,{onClick:()=>c(a.id,"send"),children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Add Friend"]}):null}),e.jsxs(r,{variant:"outline",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Send Message"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"View Profile"]})]})]})]})})]})}function ke(){return e.jsx(oe,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Find CivicOS Users"}),e.jsx("p",{className:"text-gray-600",children:"Search for other civic-minded individuals to connect with and build your civic network."})]}),e.jsx(Ne,{})]})})})}export{ke as default};
