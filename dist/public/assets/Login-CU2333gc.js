import{j as e}from"./ui-wkHeCsE0.js";import{r as l}from"./vendor-DRd396Ms.js";import{p as y,u as w,x as C,q as S,T as k,g as L,h as P,S as h,i as p,n as A,j as T,L as f,t as I,I as g,E,B as O,A as G,o as U,y as R,w as q}from"./index-jYG8Moy5.js";import{C as B}from"./CanadianCoatOfArms-BERSkbO1.js";import{L as F}from"./lock-oYOti-vD.js";import{E as D}from"./eye-off-_JyHhWhX.js";function V(){const[r,d]=l.useState({username:"",password:""}),[n,j]=l.useState(!1),[i,c]=l.useState(!1),[m,x]=l.useState(""),{toast:a}=y(),[,v]=w(),N=C(),{user:o}=S(),b=async t=>{t.preventDefault(),c(!0),x("");try{const s=await q("/api/auth/login","POST",{email:r.username,password:r.password});a({title:"Login API Response",description:JSON.stringify(s),variant:"default"}),s.token?(localStorage.setItem("civicos-jwt",s.token),a({title:"Token Stored",description:s.token,variant:"default"}),await N.invalidateQueries({queryKey:["/api/auth/user"]}),setTimeout(()=>{const u=localStorage.getItem("civicos-jwt");u?(a({title:"Token in localStorage",description:u,variant:"default"}),o&&o.email?(a({title:"User after login",description:JSON.stringify(o),variant:"default"}),v("/dashboard")):a({title:"User not loaded after login",description:"User is null or missing email",variant:"destructive"})):a({title:"Token missing after storage",description:"localStorage empty",variant:"destructive"})},500)):a({title:"Login failed",description:"No token returned from server.",variant:"destructive"})}catch(s){x(s.message||"Login failed. Please check your credentials."),a({title:"Login failed",description:s.message||"Invalid credentials",variant:"destructive"})}finally{c(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-md border-b-2 border-red-600",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4"})}),e.jsxs("main",{className:"max-w-md mx-auto pt-12 pb-24 px-4",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(k,{className:"h-5 w-5 text-yellow-400"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-yellow-700 font-medium",children:[e.jsx("strong",{children:"Important Notice:"})," This is NOT an official Government of Canada website. CivicOS is an independent platform for government accountability."]})})]})})}),e.jsxs(L,{className:"shadow-lg border-0",children:[e.jsxs(P,{className:"space-y-4 pb-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-3 bg-red-600 rounded-lg",children:e.jsx(h,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"text-2xl font-bold text-gray-900",children:"Secure Access Portal"}),e.jsx(p,{className:"text-lg font-semibold text-red-600 mt-1",children:"Portail d'Accès Sécurisé"}),e.jsx(A,{className:"mt-4 text-gray-600",children:"Access the CivicOS Government Accountability Platform with your secure credentials."})]})]}),e.jsxs(T,{className:"space-y-6",children:[e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded mb-2 text-sm",children:m}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"username",className:"text-sm font-semibold text-gray-700",children:"Username / Nom d'utilisateur"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(g,{id:"username",type:"text",placeholder:"Email or Username",value:r.username,onChange:t=>d(s=>({...s,username:t.target.value})),className:"h-12 text-base",disabled:i,autoComplete:"username"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"password",className:"text-sm font-semibold text-gray-700",children:"Password / Mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(g,{id:"password",type:n?"text":"password",placeholder:"Password",value:r.password,onChange:t=>d(s=>({...s,password:t.target.value})),className:"h-12 text-base",disabled:i,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>j(!n),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:n?e.jsx(D,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})})]})]}),e.jsx(O,{type:"submit",disabled:i,className:"w-full h-12 bg-red-600 hover:bg-red-700 text-white font-semibold text-base",children:i?"Authenticating...":e.jsxs(e.Fragment,{children:["Secure Login / Connexion Sécurisée",e.jsx(G,{className:"w-4 h-4 ml-2"})]})})]}),e.jsx(U,{}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-gray-100 rounded-lg",children:[e.jsx(h,{className:"w-4 h-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Secured with Government-Grade Encryption"})]})})]})]})]}),e.jsx("footer",{className:"bg-gray-100 border-t-2 border-red-600 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[e.jsxs("div",{className:"flex justify-center items-center space-x-2 mb-4",children:[e.jsx(B,{size:"sm"}),e.jsx("span",{className:"font-bold text-gray-900",children:"CivicOS"}),e.jsx(R,{variant:"outline",className:"ml-2 text-yellow-700 border-yellow-400",children:"Independent Platform"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Independent Canadian Government Accountability Platform",e.jsx("br",{}),"Plateforme Indépendante de Responsabilité Gouvernementale Canadienne"]}),e.jsxs("p",{className:"text-xs text-yellow-600 font-medium mt-2",children:["* Not affiliated with the Government of Canada",e.jsx("br",{}),"* Non affilié au gouvernement du Canada"]})]})})]})}export{V as default};
