import{K as d,E as c,r as a,an as l}from"./index-D74MF8tO.js";function n(){return localStorage.getItem("civicos-jwt")||""}const r=l.apiUrl;function y(){return d({queryKey:["civicSocialFeed"],queryFn:async()=>{const t=n();if(!t)throw new Error("Authentication required");const e=await fetch(`${r}/api/social/feed`,{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)throw e.status===401||e.status===403?(localStorage.removeItem("civicos-jwt"),new Error("Authentication required")):new Error("Failed to fetch feed");const i=await e.json();return i.success?i.feed||[]:[]},retry:(t,e)=>e.message==="Authentication required"?!1:t<3})}function h(){const t=c();return a({mutationFn:async e=>{const i=n(),o=await fetch(`${r}/api/social/posts`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(e)});if(!o.ok)throw new Error("Failed to create post");return o.json()},onSuccess:()=>t.invalidateQueries({queryKey:["civicSocialFeed"]})})}function w(){const t=c();return a({mutationFn:async({postId:e,...i})=>{const o=n(),s=await fetch(`${r}/api/social/posts/${e}/comment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(i)});if(!s.ok)throw new Error("Failed to add comment");return s.json()},onSuccess:()=>t.invalidateQueries({queryKey:["civicSocialFeed"]})})}function S(){const t=c();return a({mutationFn:async({postId:e,reaction:i="like"})=>{const o=n(),s=await fetch(`${r}/api/social/posts/${e}/like`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({reaction:i})});if(!s.ok)throw new Error("Failed to like post");return s.json()},onSuccess:()=>t.invalidateQueries({queryKey:["civicSocialFeed"]})})}function p(){return d({queryKey:["civicSocialFriends"],queryFn:async()=>{const t=n();if(!t)throw new Error("Authentication required");const e=await fetch(`${r}/api/social/friends`,{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)throw e.status===401||e.status===403?(localStorage.removeItem("civicos-jwt"),new Error("Authentication required")):new Error("Failed to fetch friends");const i=await e.json();return i.success?i:{friends:[],received:[],sent:[]}},retry:(t,e)=>e.message==="Authentication required"?!1:t<3})}function v(){const t=c();return a({mutationFn:async({friendId:e})=>{const i=n(),o=await fetch(`${r}/api/social/friends`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({friendId:e})});if(!o.ok)throw new Error("Failed to add friend");return o.json()},onSuccess:()=>t.invalidateQueries({queryKey:["civicSocialFriends"]})})}function F(){const t=c();return a({mutationFn:async({friendId:e})=>{const i=n(),o=await fetch(`${r}/api/social/friends/accept`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({friendId:e})});if(!o.ok)throw new Error("Failed to accept friend request");return o.json()},onSuccess:()=>t.invalidateQueries({queryKey:["civicSocialFriends"]})})}function m(){const t=c();return a({mutationFn:async({friendId:e})=>{const i=n(),o=await fetch(`${r}/api/social/friends/remove`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({friendId:e})});if(!o.ok)throw new Error("Failed to remove friend");return o.json()},onSuccess:()=>t.invalidateQueries({queryKey:["civicSocialFriends"]})})}function C(){return a({mutationFn:async({userId:t,type:e,title:i,message:o})=>{const s=n(),u=await fetch(`${r}/api/social/notifications`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({userId:t,type:e,title:i,message:o})});if(!u.ok)throw new Error("Failed to send notification");return u.json()}})}function q(){const t=c();return a({mutationFn:async({followingId:e})=>{const i=n(),o=await fetch(`${r}/api/social/follow`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({followingId:e})});if(!o.ok)throw new Error("Failed to follow user");return o.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["civicSocialFeed"]}),t.invalidateQueries({queryKey:["civicSocialFriends"]})}})}export{p as a,h as b,S as c,w as d,C as e,q as f,v as g,F as h,m as i,y as u};
