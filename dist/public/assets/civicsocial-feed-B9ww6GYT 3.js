import{r as a,j as e}from"./ui-SeOhkiHV.js";import{z as he,q as xe,p as pe,E as je,K as ve,r as u,B as n,R as ye,$ as K,D as ge,a as fe,b as Ne,c as Se,d as be,L,a1 as Pe,M as Ce,ah as U,a2 as we,y as r,ai as ke,l as Te,I as Fe}from"./app-C-GM7XxL.js";import{S as v,a as y,b as g,c as f,d as i}from"./select-CKlulwV-.js";import{C as N,a as Le,b as Me,c as qe,d as c,e as Ve,f as Ie,T as Oe,g as De}from"./CivicSocialCard-k3Mh961f.js";import{P as M}from"./plus-xvR_H3_V.js";import{T as Ee}from"./tag-Cw_x9_WO.js";import{C as Qe}from"./camera-Xt9CU6Qo.js";import{T as Re}from"./trending-up-Dwe9HPWm.js";import"./vendor-BtP0CW_r.js";import"./index-DfnTg3gV.js";import"./bookmark-XkD9gJR5.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=he("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function ts(){const{user:ze,isAuthenticated:Ae}=xe(),{toast:S}=pe(),o=je(),[$,l]=a.useState(!1),[q,Ke]=a.useState("following"),[b,W]=a.useState("all"),[V,H]=a.useState(""),[I,Y]=a.useState("latest"),[P,G]=a.useState({}),O=(s,t)=>G(d=>({...d,[s]:t})),[m,D]=a.useState(""),[E,Q]=a.useState("post"),[R,B]=a.useState("public"),[J,X]=a.useState([]),[Z,_]=a.useState(""),[ee,se]=a.useState(""),[Ue,C]=a.useState(null),[h,w]=a.useState(null),{data:x,isLoading:k,error:te,refetch:z}=ve({queryKey:["socialFeed",q,b,I,V],queryFn:async()=>{const s=q==="following"?"following":b==="public"?"public":"all",t=new URLSearchParams({scope:s});return(await r(`/api/social/feed?${t.toString()}`)).feed||[]},staleTime:3e4}),T=u({mutationFn:async s=>await r("/api/social/posts","POST",s),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]}),l(!1),ue(),S({title:"Post created!",description:"Your post has been shared successfully."})},onError:s=>{S({title:"Error creating post",description:s.message||"Failed to create post. Please try again.",variant:"destructive"})}}),ae=u({mutationFn:async s=>await r(`/api/social/posts/${s}/like`,"POST"),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]})}}),F=u({mutationFn:async({postId:s,content:t})=>await r(`/api/social/posts/${s}/comment`,"POST",{content:t}),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]})}}),ie=u({mutationFn:async s=>await r(`/api/social/posts/${s}/share`,"POST"),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]}),S({title:"Post shared!",description:"Your post has been shared successfully."})}}),ne=u({mutationFn:async s=>await r("/api/social/bookmarks","POST",{postId:s}),onSuccess:()=>{o.invalidateQueries({queryKey:["socialFeed"]})}}),le=async s=>{if(s.preventDefault(),!m.trim())return;const t={content:m,type:E,visibility:R,tags:J,location:Z,mood:ee,...h&&{imageUrl:h}};T.mutate(t)},re=s=>{ae.mutate(s)},A=s=>{const t=(P[s]||"").trim();t&&(F.mutate({postId:s,content:t}),O(s,""))},ce=s=>{ie.mutate(s)},oe=s=>{ne.mutate(s)},de=s=>{var d;const t=(d=s.target.files)==null?void 0:d[0];t&&(C(t),w(URL.createObjectURL(t)))},ue=()=>{D(""),Q("post"),B("public"),X([]),_(""),se(""),C(null),w(null)},p=e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Quick Actions",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(n,{onClick:()=>l(!0),className:"w-full social-button-primary",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Create Post"]}),e.jsxs(n,{variant:"outline",className:"w-full",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Share Photo"]}),e.jsxs(n,{variant:"outline",className:"w-full",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Share Video"]})]})}),e.jsx(c,{title:"Trending Topics",children:e.jsx("div",{className:"space-y-2",children:["#CanadianPolitics","#CivicEngagement","#Democracy","#VotingRights"].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50 hover:bg-muted transition-colors cursor-pointer",children:[e.jsx("span",{className:"text-sm font-medium",children:s}),e.jsx(Re,{className:"w-4 h-4 text-muted-foreground"})]},s))})}),e.jsx(c,{title:"Online Friends",children:e.jsx("div",{className:"space-y-2",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded-md hover:bg-muted transition-colors cursor-pointer",children:[e.jsx("div",{className:"social-avatar-online w-8 h-8",children:e.jsxs("div",{className:"w-full h-full rounded-full bg-social-primary flex items-center justify-center text-white text-xs font-medium",children:["U",s]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium truncate",children:["User ",s]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Online"})]})]},s))})})]}),j=e.jsx(De,{title:"CivicSocial Feed",subtitle:"Stay connected with your civic community",actions:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>z(),disabled:k,children:k?e.jsx(U,{className:"w-4 h-4 animate-spin"}):e.jsx(Be,{className:"w-4 h-4"})}),e.jsxs(n,{onClick:()=>l(!0),className:"social-button-primary",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"New Post"]})]})}),me=e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 p-4 bg-card border border-border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Fe,{placeholder:"Search posts...",value:V,onChange:s=>H(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{value:b,onValueChange:s=>W(s),children:[e.jsx(y,{className:"w-32",children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(i,{value:"all",children:"All Posts"}),e.jsx(i,{value:"public",children:"Public"}),e.jsx(i,{value:"friends",children:"Friends"}),e.jsx(i,{value:"private",children:"Private"})]})]}),e.jsxs(v,{value:I,onValueChange:s=>Y(s),children:[e.jsx(y,{className:"w-32",children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(i,{value:"latest",children:"Latest"}),e.jsx(i,{value:"popular",children:"Popular"}),e.jsx(i,{value:"trending",children:"Trending"})]})]})]})]});return k?e.jsx(N,{header:j,sidebar:p,children:e.jsx(Le,{title:"Loading your feed...",description:"We're gathering the latest posts from your civic community."})}):te?e.jsx(N,{header:j,sidebar:p,children:e.jsx(Me,{title:"Failed to load feed",description:"We couldn't load your social feed. Please check your connection and try again.",retry:()=>z()})}):!x||x.length===0?e.jsx(N,{header:j,sidebar:p,children:e.jsx(qe,{title:"No posts yet",description:"Be the first to share something with your civic community!",icon:e.jsx(ye,{className:"w-8 h-8"}),action:e.jsxs(n,{onClick:()=>l(!0),className:"social-button-primary",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Create Your First Post"]})})}):e.jsxs(N,{header:j,sidebar:p,children:[e.jsx(c,{children:me}),e.jsx(c,{children:e.jsx(Ve,{children:x.map(s=>e.jsx(Ie,{post:s,onLike:re,onComment:A,onShare:ce,onBookmark:oe},s.id))})}),e.jsx(c,{children:x.map(s=>e.jsxs("div",{className:"mt-2 p-3 border border-border rounded-lg bg-card",children:[e.jsx("div",{className:"flex items-start gap-2",children:e.jsx(K,{placeholder:"Write a comment...",value:P[s.id]||"",onChange:t=>O(s.id,t.target.value),className:"min-h-[60px]"})}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(n,{size:"sm",className:"social-button-primary",disabled:F.isPending||!(P[s.id]||"").trim(),onClick:()=>A(s.id),children:F.isPending?"Postingâ€¦":"Comment"})})]},`comment-box-${s.id}`))}),e.jsx(ge,{open:$,onOpenChange:l,children:e.jsxs(fe,{className:"max-w-2xl",children:[e.jsxs(Ne,{children:[e.jsx(Se,{children:"Create a New Post"}),e.jsx(be,{children:"Share your thoughts, ideas, or updates with the civic community."})]}),e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"content",children:"What's on your mind?"}),e.jsx(K,{id:"content",placeholder:"Share your thoughts with the civic community...",value:m,onChange:s=>D(s.target.value),className:"min-h-[120px]",required:!0})]}),h&&e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h,alt:"Preview",className:"w-full rounded-lg max-h-64 object-cover"}),e.jsx(n,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{C(null),w(null)},children:e.jsx(Oe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"type",children:"Post Type"}),e.jsxs(v,{value:E,onValueChange:s=>Q(s),children:[e.jsx(y,{children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(i,{value:"post",children:"Post"}),e.jsx(i,{value:"share",children:"Share"}),e.jsx(i,{value:"poll",children:"Poll"}),e.jsx(i,{value:"event",children:"Event"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"visibility",children:"Visibility"}),e.jsxs(v,{value:R,onValueChange:s=>B(s),children:[e.jsx(y,{children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(i,{value:"public",children:"Public"}),e.jsx(i,{value:"friends",children:"Friends"}),e.jsx(i,{value:"private",children:"Private"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(n,{type:"button",variant:"outline",size:"sm",onClick:()=>{var s;return(s=document.getElementById("image-upload"))==null?void 0:s.click()},children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Add Image"]}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",onChange:de,className:"hidden"}),e.jsxs(n,{type:"button",variant:"outline",size:"sm",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Add Location"]}),e.jsxs(n,{type:"button",variant:"outline",size:"sm",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Add Tags"]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(n,{type:"submit",className:"social-button-primary",disabled:T.isPending||!m.trim(),children:[T.isPending?e.jsx(U,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(we,{className:"w-4 h-4 mr-2"}),"Post"]})]})]})]})})]})}export{ts as default};
