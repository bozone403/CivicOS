import{j as e}from"./ui-CDUWW_Ri.js";import{z as Q,q as K,E as W,p as X,r as E,g as d,h as m,i as h,n as x,j as p,X as Z,Y as _,Z as $,B as y,S as ee,L as t,I as n,J as se,a5 as T,t as ae,o as ie,G as re,y as R}from"./index-JnBwAcKx.js";import{S as c}from"./switch-TZv0p4x_.js";import{A as V,a as G}from"./alert-CUUlvFlq.js";import{r as o}from"./vendor-1XCZ5AD1.js";import{C as te}from"./camera-BBcvDFaV.js";import{L as ne}from"./lock-CPsCfaxQ.js";import{S as ce}from"./smartphone-B-EwYNqx.js";import{G as le}from"./globe-B0qnoB1F.js";import"./index-q7PMzjPi.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=Q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function ge(){var I;const{user:i}=K(),q=W(),{toast:u}=X(),[j,f]=o.useState({email:!0,push:!1,sms:!1,bills:!0,elections:!0,petitions:!1}),[P,b]=o.useState({publicProfile:!1,showVotes:!1,showLocation:!0}),[r,v]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[A,w]=o.useState(""),[z,C]=o.useState(!1),[S,L]=o.useState(null),[B,M]=o.useState(null),U=o.useRef(null);if(!i)return e.jsx("div",{className:"min-h-screen flex items-center justify-center text-gray-500",children:"Please log in to view your settings."});const N=E({mutationFn:async s=>await(await R("/api/auth/change-password","POST",s)).json(),onSuccess:()=>{v({currentPassword:"",newPassword:"",confirmPassword:""}),w(""),C(!0),u({title:"Password Changed",description:"Your password has been updated successfully"}),setTimeout(()=>C(!1),3e3)},onError:s=>{w(s.message||"Failed to change password"),C(!1)}}),F=E({mutationFn:async s=>i?R("/api/users/profile","PUT",s):Promise.reject("No user"),onSuccess:()=>{q.invalidateQueries({queryKey:["/api/auth/user"]}),u({title:"Profile updated!",description:"Your changes have been saved."})}}),Y=s=>{if(s.preventDefault(),w(""),!r.currentPassword||!r.newPassword||!r.confirmPassword){w("All password fields are required");return}if(r.newPassword!==r.confirmPassword){w("New passwords do not match");return}if(r.newPassword.length<6){w("New password must be at least 6 characters");return}N.mutate({currentPassword:r.currentPassword,newPassword:r.newPassword})},k=E({mutationFn:async s=>{const a=new FormData;a.append("profilePicture",s);const l=await fetch("/api/auth/upload-profile-picture",{method:"POST",body:a});if(!l.ok)throw new Error("Failed to upload profile picture");return await l.json()},onSuccess:()=>{u({title:"Profile Picture Updated",description:"Your profile picture has been updated successfully"}),L(null),M(null),window.location.reload()},onError:s=>{u({title:"Upload Failed",description:s.message||"Failed to upload profile picture",variant:"destructive"})}}),H=s=>{var l;const a=(l=s.target.files)==null?void 0:l[0];if(a){if(a.size>5*1024*1024){u({title:"File Too Large",description:"Please select an image smaller than 5MB",variant:"destructive"});return}if(!a.type.startsWith("image/")){u({title:"Invalid File Type",description:"Please select an image file",variant:"destructive"});return}L(a);const g=new FileReader;g.onload=J=>{var D;M((D=J.target)==null?void 0:D.result)},g.readAsDataURL(a)}},O=()=>{S&&k.mutate(S)};return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account preferences and privacy settings"})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(te,{className:"h-5 w-5"}),e.jsx("span",{children:"Profile Picture"})]}),e.jsx(x,{children:"Update your profile picture"})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs(Z,{className:"w-24 h-24",children:[e.jsx(_,{src:B||(i==null?void 0:i.profileImageUrl)}),e.jsx($,{className:"text-2xl",children:typeof(i==null?void 0:i.firstName)=="string"?(I=i==null?void 0:i.firstName)==null?void 0:I[0]:"U"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:U,type:"file",accept:"image/*",onChange:H,className:"hidden"}),e.jsxs(y,{onClick:()=>{var s;return(s=U.current)==null?void 0:s.click()},variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Choose New Picture"})]}),S&&e.jsx(y,{onClick:O,disabled:k.isPending,className:"w-full",children:k.isPending?"Uploading...":"Save Profile Picture"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload a JPG, PNG, or GIF. Max file size: 5MB"})]})]})})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsx("span",{children:"Account Information"})]}),e.jsx(x,{children:"Update your personal information"})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("form",{onSubmit:s=>{var a,l,g;s.preventDefault(),F.mutate({firstName:(a=s.target.firstName)==null?void 0:a.value,lastName:(l=s.target.lastName)==null?void 0:l.value,email:(g=s.target.email)==null?void 0:g.value})},className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"profileFirstName",children:"First Name"}),e.jsx(n,{id:"profileFirstName",name:"firstName",defaultValue:(i==null?void 0:i.firstName)||"",placeholder:"Enter your first name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"profileLastName",children:"Last Name"}),e.jsx(n,{id:"profileLastName",name:"lastName",defaultValue:(i==null?void 0:i.lastName)||"",placeholder:"Enter your last name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"profileEmail",children:"Email Address"}),e.jsx(n,{id:"profileEmail",name:"email",type:"email",defaultValue:(i==null?void 0:i.email)||"",placeholder:"Enter your email",autoComplete:"username"})]}),e.jsx(y,{type:"submit",disabled:F.isPending,children:F.isPending?"Saving...":"Save Changes"})]})})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Password Security"})]}),e.jsx(x,{children:"Change your account password"})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[A&&e.jsx(V,{variant:"destructive",children:e.jsx(G,{children:A})}),z&&e.jsxs(V,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx(G,{children:"Password changed successfully!"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"currentPassword",children:"Current Password"}),e.jsx(n,{id:"currentPassword",type:"password",value:r.currentPassword,onChange:s=>v(a=>({...a,currentPassword:s.target.value})),placeholder:"Enter current password",disabled:N.isPending,autoComplete:"current-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"newPassword",children:"New Password"}),e.jsx(n,{id:"newPassword",type:"password",value:r.newPassword,onChange:s=>v(a=>({...a,newPassword:s.target.value})),placeholder:"Enter new password (min 6 characters)",disabled:N.isPending,autoComplete:"new-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsx(n,{id:"confirmPassword",type:"password",value:r.confirmPassword,onChange:s=>v(a=>({...a,confirmPassword:s.target.value})),placeholder:"Confirm new password",disabled:N.isPending,autoComplete:"new-password"})]}),e.jsx(y,{type:"submit",disabled:N.isPending,className:"bg-slate-800 hover:bg-slate-700",children:N.isPending?"Updating...":"Change Password"})]})})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"h-5 w-5"}),e.jsx("span",{children:"Notification Preferences"})]}),e.jsx(x,{children:"Choose how you want to be notified about civic activities"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Notification Methods"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Email notifications"})]}),e.jsx(c,{checked:j.email,onCheckedChange:s=>f(a=>({...a,email:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"Push notifications"})]}),e.jsx(c,{checked:j.push,onCheckedChange:s=>f(a=>({...a,push:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:"SMS notifications"})]}),e.jsx(c,{checked:j.sms,onCheckedChange:s=>f(a=>({...a,sms:s}))})]})]})]}),e.jsx(ie,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Content Notifications"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"New bills and legislation"}),e.jsx(c,{checked:j.bills,onCheckedChange:s=>f(a=>({...a,bills:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Election updates"}),e.jsx(c,{checked:j.elections,onCheckedChange:s=>f(a=>({...a,elections:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Petition milestones"}),e.jsx(c,{checked:j.petitions,onCheckedChange:s=>f(a=>({...a,petitions:s}))})]})]})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{children:"Privacy Settings"})]}),e.jsx(x,{children:"Control what information is visible to others"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow others to see your civic engagement stats"})]}),e.jsx(c,{checked:P.publicProfile,onCheckedChange:s=>b(a=>({...a,publicProfile:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Show Voting History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Display your votes on bills and petitions"})]}),e.jsx(c,{checked:P.showVotes,onCheckedChange:s=>b(a=>({...a,showVotes:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Location-based Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Show relevant local politicians and issues"})]}),e.jsx(c,{checked:P.showLocation,onCheckedChange:s=>b(a=>({...a,showLocation:s}))})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-5 w-5"}),e.jsx("span",{children:"Regional Preferences"})]}),e.jsx(x,{children:"Customize content for your location"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"province",children:"Province/Territory"}),e.jsx(n,{id:"province",placeholder:"Select your province",defaultValue:"Ontario"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"riding",children:"Federal Riding"}),e.jsx(n,{id:"riding",placeholder:"Enter your riding"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"municipality",children:"Municipality"}),e.jsx(n,{id:"municipality",placeholder:"Enter your city/town"})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(h,{className:"text-red-600",children:"Account Actions"}),e.jsx(x,{children:"Manage your account status"})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-red-700",children:"Permanently delete your account and all associated data"})]}),e.jsx(y,{variant:"destructive",size:"sm",children:"Delete Account"})]})})]})]})})})}export{ge as default};
