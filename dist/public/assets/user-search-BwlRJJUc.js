import{j as e}from"./ui-B-8yHimL.js";import{r as x}from"./vendor-DRd396Ms.js";import{q as w,r as C,J as q,h as n,i as u,j as p,m as j,k as c,I as F,B as f,R as A,W as P,X as R,G as T,M as k,S as U,ah as I,x as g,al as L}from"./index-B6pmLMut.js";import{A as E}from"./award-B_1FJY6S.js";function $(){const[a,v]=x.useState(""),[d,o]=x.useState(!1),{toast:r}=w(),{isAuthenticated:l}=C(),{data:t,isLoading:h,refetch:N}=q({queryKey:["user-search",a,l],queryFn:async()=>!a.trim()||a.length<2?{users:[],total:0,query:a,limit:20,offset:0}:await g(`${l?"/api/users/search":"/api/users/search/public"}?q=${encodeURIComponent(a)}`,"GET"),enabled:!1,staleTime:5*60*1e3}),m=async()=>{if(!a.trim()||a.length<2){r({title:"Search Error",description:"Please enter at least 2 characters to search",variant:"destructive"});return}o(!0);try{await N()}catch{r({title:"Search Failed",description:"Failed to search for users. Please try again.",variant:"destructive"})}finally{o(!1)}},y=async(s,i)=>{if(!l){r({title:"Authentication Required",description:"Please log in to add friends.",variant:"destructive"});return}try{await g("/api/friends/request","POST",{friendId:s}),r({title:"Friend Request Sent",description:`Friend request sent to ${i}`})}catch{r({title:"Request Failed",description:"Failed to send friend request. Please try again.",variant:"destructive"})}},b=s=>{switch(s.toLowerCase()){case"champion":return"bg-purple-500";case"expert":return"bg-blue-500";case"advocate":return"bg-green-500";case"active":return"bg-yellow-500";default:return"bg-gray-500"}},S=s=>s>=90?"text-green-600":s>=70?"text-yellow-600":"text-red-600";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{children:[e.jsx(u,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5"}),"Search Users"]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{placeholder:"Search by name, email, or location...",value:a,onChange:s=>v(s.target.value),onKeyPress:s=>s.key==="Enter"&&m(),className:"flex-1"}),e.jsx(f,{onClick:m,disabled:d||!a.trim(),children:d?"Searching...":"Search"})]})})]}),t&&t.users.length>0&&e.jsxs(n,{children:[e.jsx(u,{children:e.jsxs(p,{children:["Found ",t.total," user",t.total!==1?"s":""]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:t.users.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(A,{className:"h-12 w-12",children:[e.jsx(P,{src:s.avatar}),e.jsx(R,{children:s.name.split(" ").map(i=>i[0]).join("").toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsx(T,{className:b(s.civicLevel),children:s.civicLevel})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-4 w-4"}),s.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-4 w-4"}),s.civicPoints," points"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:`h-4 w-4 ${S(s.trustScore)}`}),"Trust: ",s.trustScore,"%"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Member since ",s.memberSince]})]})]}),e.jsxs(f,{onClick:()=>y(s.id,s.name),size:"sm",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Add Friend"]})]},s.id))})})]}),t&&t.users.length===0&&a&&!h&&e.jsx(n,{children:e.jsxs(c,{className:"text-center py-8",children:[e.jsx(j,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No users found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try searching with different terms or check your spelling."})]})}),h&&e.jsx(n,{children:e.jsxs(c,{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Searching for users..."})]})})]})}function O(){return e.jsx(L,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Find CivicOS Users"}),e.jsx("p",{className:"text-gray-600",children:"Search for other civic-minded individuals to connect with and build your civic network."})]}),e.jsx($,{})]})})})}export{O as default};
