import{r as x,j as e}from"./ui-D2Re0T6U.js";import{q,p as J,K as U,F as w,B as h,l as G,I as K,v as r,g as R,h as Y,i as H,j as M,s as Q,G as $,y as O}from"./app-CDP34tcP.js";import{S as j,a as g,b as p,c as v,d as l}from"./select-CrjjNc36.js";import{P as W}from"./progress-DrBYynz5.js";import{V as X,I as Z}from"./InteractiveContent-CRIxjRYD.js";import{F as ee}from"./filter-4s4JRBcM.js";import{C as se}from"./calendar-BBsjLFHW.js";import{C as te}from"./clock-B6e33f1c.js";import{E as ae}from"./external-link-C1maA0zd.js";import"./vendor-BtP0CW_r.js";import"./index-B4pxPuSB.js";import"./thumbs-up-DwuAKGK7.js";import"./pen-UOGIAb5c.js";import"./trash-2-BXXfZXt5.js";function Ne(){const{user:re,isAuthenticated:le}=q(),{toast:S}=J(),[i,C]=x.useState(""),[n,F]=x.useState("all"),[c,B]=x.useState("all"),[d,L]=x.useState("all"),[t,y]=x.useState(null),{data:o=[],isLoading:P,error:k}=U({queryKey:["/api/bills"],queryFn:async()=>{try{return await O("/api/bills","GET")||[]}catch(s){return console.error("Failed to fetch bills:",s),[]}},staleTime:300*1e3}),u=o.filter(s=>{var f,b;const a=s.title.toLowerCase().includes(i.toLowerCase())||((f=s.description)==null?void 0:f.toLowerCase().includes(i.toLowerCase()))||s.billNumber.toLowerCase().includes(i.toLowerCase())||((b=s.sponsor)==null?void 0:b.toLowerCase().includes(i.toLowerCase())),E=n==="all"||s.status===n,z=c==="all"||s.category===c,_=d==="all"||s.jurisdiction===d;return a&&E&&z&&_}),T=[...new Set(o.map(s=>s.status))].filter(Boolean),V=[...new Set(o.map(s=>s.category))].filter(Boolean),D=[...new Set(o.map(s=>s.jurisdiction))].filter(Boolean),A=s=>{switch(s==null?void 0:s.toLowerCase()){case"introduced":return"bg-blue-100 text-blue-800";case"passed":return"bg-green-100 text-green-800";case"defeated":return"bg-red-100 text-red-800";case"amended":return"bg-yellow-100 text-yellow-800";case"referred":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},I=s=>{switch(s==null?void 0:s.toLowerCase()){case"first reading":return"bg-blue-100 text-blue-800";case"second reading":return"bg-yellow-100 text-yellow-800";case"third reading":return"bg-green-100 text-green-800";case"committee":return"bg-purple-100 text-purple-800";case"royal assent":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-CA",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},N=s=>{if(!s||!s.yes||!s.no)return 0;const a=s.yes+s.no+(s.neutral||0);return a>0?Math.round(s.yes/a*100):0};return P?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,a)=>e.jsx("div",{className:"h-64 bg-gray-200 rounded"},a))})]})})}):k?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center py-20",children:[e.jsx(w,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Failed to Load Bills"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to fetch bills data. Please try again later."}),e.jsx(h,{onClick:()=>window.location.reload(),children:"Retry"})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bills & Legislation"}),e.jsx("p",{className:"text-gray-600",children:"Track and vote on current bills in Parliament and provincial legislatures"})]}),e.jsxs("div",{className:"mb-8 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(K,{placeholder:"Search bills by title, number, or sponsor...",value:i,onChange:s=>C(s.target.value),className:"pl-10"})]})}),e.jsxs(j,{value:n,onValueChange:F,children:[e.jsx(g,{className:"w-full md:w-48",children:e.jsx(p,{placeholder:"Filter by status"})}),e.jsxs(v,{children:[e.jsx(l,{value:"all",children:"All Statuses"}),T.map(s=>e.jsx(l,{value:s,children:s},s))]})]}),e.jsxs(j,{value:c,onValueChange:B,children:[e.jsx(g,{className:"w-full md:w-48",children:e.jsx(p,{placeholder:"Filter by category"})}),e.jsxs(v,{children:[e.jsx(l,{value:"all",children:"All Categories"}),V.map(s=>e.jsx(l,{value:s,children:s},s))]})]}),e.jsxs(j,{value:d,onValueChange:L,children:[e.jsx(g,{className:"w-full md:w-48",children:e.jsx(p,{placeholder:"Filter by jurisdiction"})}),e.jsxs(v,{children:[e.jsx(l,{value:"all",children:"All Jurisdictions"}),D.map(s=>e.jsx(l,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",u.length," of ",o.length," bills"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Active filters: "}),n!=="all"&&e.jsx(r,{variant:"secondary",children:n}),c!=="all"&&e.jsx(r,{variant:"secondary",children:c}),d!=="all"&&e.jsx(r,{variant:"secondary",children:d})]})]})]}),u.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx(w,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Bills Found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search terms or filters."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map(s=>e.jsxs(R,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsx(Y,{className:"pb-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(H,{className:"text-lg leading-tight mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(r,{variant:"outline",className:"font-mono",children:s.billNumber}),e.jsx(r,{className:A(s.status),children:s.status}),e.jsx(r,{className:I(s.stage),children:s.stage})]})]})})}),e.jsxs(M,{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:s.summary||s.description||"No summary available"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.sponsor," ",s.sponsorParty&&`(${s.sponsorParty})`]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsxs("span",{children:["Introduced: ",m(s.introducedDate)]})]}),s.nextVoteDate&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsxs("span",{children:["Next vote: ",m(s.nextVoteDate)]})]})]}),s.publicSupport&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Public Support"}),e.jsxs("span",{className:"font-medium",children:[N(s.publicSupport),"%"]})]}),e.jsx(W,{value:N(s.publicSupport),className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Yes: ",s.publicSupport.yes]}),e.jsxs("span",{children:["No: ",s.publicSupport.no]}),e.jsxs("span",{children:["Neutral: ",s.publicSupport.neutral||0]})]})]}),s.voteStats&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Parliament Votes"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Yes:"}),e.jsx("span",{className:"font-medium text-green-600",children:s.voteStats.yes_votes})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"No:"}),e.jsx("span",{className:"font-medium text-red-600",children:s.voteStats.no_votes})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Abstain:"}),e.jsx("span",{className:"font-medium text-gray-600",children:s.voteStats.abstentions})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{className:"font-medium",children:s.voteStats.total_votes})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(X,{targetType:"bill",targetId:s.id,size:"sm"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>y(s),children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Details"]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>{s.governmentUrl?window.open(s.governmentUrl,"_blank"):S({title:"No link available",description:"Government link not available for this bill."})},children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),"Source"]})]})]})]})]},s.id))}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:t.title}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>y(null),children:"×"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Bill Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Number:"})," ",t.billNumber]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Stage:"})," ",t.stage]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Jurisdiction:"})," ",t.jurisdiction]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Category:"})," ",t.category]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Introduced:"})," ",m(t.introducedDate)]}),t.nextVoteDate&&e.jsxs("div",{children:[e.jsx("strong",{children:"Next Vote:"})," ",m(t.nextVoteDate)]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Sponsor"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Name:"})," ",t.sponsor]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Party:"})," ",t.sponsorParty]})]})]})]}),t.summary&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Summary"}),e.jsx("p",{className:"text-gray-700",children:t.summary})]}),t.keyProvisions&&t.keyProvisions.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Key Provisions"}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-700",children:t.keyProvisions.map((s,a)=>e.jsx("li",{children:s},a))})]}),e.jsx(Z,{targetType:"bill",targetId:t.id,title:t.title,description:t.summary||t.description||"",showVoting:!0,showComments:!0,showSharing:!0})]})]})})})]})})}export{Ne as default};
