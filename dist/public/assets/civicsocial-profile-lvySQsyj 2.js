import{j as e}from"./ui-CDUWW_Ri.js";import{r as t}from"./vendor-1XCZ5AD1.js";import{q as R,p as $,E as z,r as Q,g as r,B as x,j as H,X as M,Y,Z as V,a2 as W,R as X,D as Z,a0 as _,a as G,b as J,c as ee,d as se,I as k,$ as ae,y as le}from"./index-DhTCSRfs.js";import{u as te,a as ie,b as re,c as ne,d as oe,e as de}from"./useCivicSocial-Ce-guB7o.js";import{U as ce}from"./UnifiedSocialPost-DvKvhjGV.js";import{T as me,a as xe,b as u,c as h}from"./tabs-Do8ugyXE.js";function l({className:s="",...f}){return e.jsx("div",{className:"animate-pulse bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 bg-[length:200%_100%] "+s,style:{backgroundSize:"200% 100%"},...f})}function Ee(){var S;const{user:s,isLoading:f,isAuthenticated:ue}=R(),{data:N,isLoading:E,error:he}=te(),{data:b}=ie();re(),ne(),oe(),de();const[fe,be]=t.useState(""),[ge,je]=t.useState({}),[Ne,pe]=t.useState({}),[ve,we]=t.useState(null),[ye,Ce]=t.useState(null),[F,n]=t.useState(!1),[p,U]=t.useState((s==null?void 0:s.firstName)||""),[v,L]=t.useState((s==null?void 0:s.lastName)||""),[w,K]=t.useState((s==null?void 0:s.bio)||""),[q,Se]=t.useState((s==null?void 0:s.profileImageUrl)||"");t.useRef(null);const{toast:B}=$(),y=z(),C=(b==null?void 0:b.friends)||[],[O,o]=t.useState("posts"),g=Q({mutationFn:async a=>le("/api/users/profile","PUT",a),onSuccess:()=>{y.invalidateQueries({queryKey:["/api/auth/user"]}),n(!1),B({title:"Profile updated!",description:"Your changes have been saved."})}}),m=N?N.filter(a=>String(a.userId)===String(s==null?void 0:s.id)):[],j=s?s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.firstName||s.lastName||s.email||"Anonymous":"Anonymous";function d(a){return i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),a())}}return f||E?e.jsxs("div",{className:"w-full max-w-3xl mx-auto flex flex-col gap-6",children:[e.jsxs("div",{className:"relative w-full h-56 md:h-64 bg-gradient-to-r from-blue-600 to-purple-700 rounded-b-3xl shadow-lg overflow-hidden mb-8",children:[e.jsx(l,{className:"absolute inset-0 w-full h-full"}),e.jsxs("div",{className:"absolute left-1/2 bottom-0 transform -translate-x-1/2 translate-y-1/2 flex flex-col items-center",children:[e.jsx(l,{className:"w-32 h-32 rounded-full border-4 border-white shadow-xl bg-white"}),e.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[e.jsx(l,{className:"h-8 w-48 rounded mb-2"}),e.jsx(l,{className:"h-5 w-32 rounded mb-1"}),e.jsx(l,{className:"h-5 w-64 rounded mb-2"}),e.jsx(l,{className:"h-8 w-32 rounded"})]})]})]}),e.jsxs("div",{className:"flex w-full justify-center gap-2 bg-white rounded-xl shadow mb-6",children:[e.jsx(l,{className:"h-10 w-24 rounded-full"}),e.jsx(l,{className:"h-10 w-24 rounded-full"}),e.jsx(l,{className:"h-10 w-24 rounded-full"}),e.jsx(l,{className:"h-10 w-24 rounded-full"})]}),e.jsxs(r,{className:"p-4 mb-4 flex items-start gap-3 bg-white shadow-lg rounded-xl border border-gray-200 fade-in-up",children:[e.jsx(l,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"flex-1 flex flex-col gap-2",children:[e.jsx(l,{className:"h-10 w-full rounded-lg mb-2"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{className:"h-8 w-20 rounded-full"}),e.jsx(l,{className:"h-8 w-20 rounded-full"})]})]})]}),[1,2,3].map(a=>e.jsxs(r,{className:"p-4 flex items-start gap-3 bg-white shadow-lg rounded-xl border border-gray-200 fade-in-up",children:[e.jsx(l,{className:"w-12 h-12 rounded-full"}),e.jsxs("div",{className:"flex-1 flex flex-col gap-2",children:[e.jsx(l,{className:"h-6 w-1/2 rounded"}),e.jsx(l,{className:"h-4 w-1/3 rounded"}),e.jsx(l,{className:"h-10 w-full rounded-lg mt-2"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(l,{className:"h-8 w-16 rounded-full"}),e.jsx(l,{className:"h-8 w-16 rounded-full"}),e.jsx(l,{className:"h-8 w-16 rounded-full"})]})]})]},a))]}):s?e.jsxs("div",{className:"w-full max-w-3xl mx-auto flex flex-col gap-6",children:[e.jsxs("div",{className:"relative w-full h-56 md:h-64 bg-gradient-to-r from-blue-600 to-purple-700 rounded-b-3xl shadow-lg overflow-hidden mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500 via-blue-700 to-purple-700 opacity-90"}),e.jsxs("div",{className:"absolute left-1/2 bottom-0 transform -translate-x-1/2 translate-y-1/2 flex flex-col items-center",children:[e.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-white shadow-xl bg-white overflow-hidden",children:s!=null&&s.profileImageUrl?e.jsx("img",{src:s==null?void 0:s.profileImageUrl,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-5xl font-bold bg-blue-600 text-white",children:j[0]})}),e.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:j}),e.jsxs("p",{className:"text-base md:text-lg text-gray-600",children:["@",(S=s==null?void 0:s.email)==null?void 0:S.split("@")[0]]}),e.jsx("p",{className:"text-base text-gray-700 mt-1",children:(s==null?void 0:s.bio)||"No bio available."}),e.jsx(x,{size:"sm",variant:"outline",className:"mt-2 focus:ring-2 focus:ring-blue-400",onClick:()=>n(!0),onKeyDown:d(()=>n(!0)),"aria-label":"Edit Profile",tabIndex:0,children:"Edit Profile"})]})]})]}),e.jsxs(me,{value:O,onValueChange:o,className:"w-full",children:[e.jsxs(xe,{className:"flex w-full justify-center gap-2 bg-white rounded-xl shadow mb-6",children:[e.jsx(u,{value:"posts",className:"px-6 py-2 font-semibold focus:ring-2 focus:ring-blue-400",tabIndex:0,"aria-label":"Posts",onKeyDown:d(()=>o("posts")),children:"Posts"}),e.jsx(u,{value:"about",className:"px-6 py-2 font-semibold focus:ring-2 focus:ring-blue-400",tabIndex:0,"aria-label":"About",onKeyDown:d(()=>o("about")),children:"About"}),e.jsx(u,{value:"friends",className:"px-6 py-2 font-semibold focus:ring-2 focus:ring-blue-400",tabIndex:0,"aria-label":"Friends",onKeyDown:d(()=>o("friends")),children:"Friends"}),e.jsx(u,{value:"photos",className:"px-6 py-2 font-semibold focus:ring-2 focus:ring-blue-400",tabIndex:0,"aria-label":"Photos",onKeyDown:d(()=>o("photos")),children:"Photos"})]}),e.jsxs(h,{value:"posts",children:[e.jsx("div",{className:"mb-4",children:e.jsx(ce,{placeholder:`What's on your mind, ${j}?`,onPostCreated:()=>{y.invalidateQueries({queryKey:["civicSocialFeed"]})}})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[m&&m.length===0&&e.jsx("div",{className:"text-muted-foreground",children:"No posts yet."}),m&&m.map(a=>{var i,c,P,D,I,A,T;return e.jsx(r,{className:"mb-4",children:e.jsx(H,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(M,{className:"w-10 h-10",children:[e.jsx(Y,{src:(i=a.user)==null?void 0:i.profileImageUrl}),e.jsx(V,{className:"bg-blue-600 text-white",children:((P=(c=a.user)==null?void 0:c.firstName)==null?void 0:P[0])||((I=(D=a.user)==null?void 0:D.email)==null?void 0:I[0])||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"font-semibold",children:[(A=a.user)==null?void 0:A.firstName," ",(T=a.user)==null?void 0:T.lastName]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-gray-800 mb-3",children:a.content}),a.imageUrl&&e.jsx("img",{src:a.imageUrl,alt:"Post",className:"rounded-lg max-w-full h-auto mb-3"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("button",{className:"flex items-center gap-1 hover:text-blue-600",children:[e.jsx(W,{className:"w-4 h-4"}),a.likesCount||0]}),e.jsxs("button",{className:"flex items-center gap-1 hover:text-blue-600",children:[e.jsx(X,{className:"w-4 h-4"}),a.commentsCount||0]})]})]})]})})},a.id)})]})]}),e.jsx(h,{value:"about",children:e.jsxs(r,{className:"p-6 bg-white shadow rounded-xl border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"About"}),e.jsx("p",{className:"text-gray-700",children:(s==null?void 0:s.bio)||"No bio available."}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"block text-sm text-gray-500",children:"Email:"}),e.jsx("span",{className:"block text-base font-medium text-gray-800",children:s==null?void 0:s.email})]})]})}),e.jsx(h,{value:"friends",children:e.jsxs(r,{className:"p-6 bg-white shadow rounded-xl border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Friends"}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-2",children:[C.length===0&&e.jsx("span",{className:"text-gray-500",children:"No friends yet."}),C.map(a=>{var i,c;return e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-lg px-3 py-2 border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold",children:((i=a.firstName)==null?void 0:i[0])||((c=a.email)==null?void 0:c[0])||"U"}),e.jsx("span",{className:"font-medium text-sm",children:a.firstName||a.email})]},a.id)})]})]})}),e.jsx(h,{value:"photos",children:e.jsxs(r,{className:"p-6 bg-white shadow rounded-xl border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Photos"}),e.jsx("span",{className:"text-gray-500",children:"No photos yet."})]})})]}),e.jsxs(Z,{open:F,onOpenChange:n,children:[e.jsx(_,{asChild:!0,children:e.jsx(x,{size:"sm",variant:"outline",className:"text-blue-700 bg-white/80 hover:bg-white",children:"Edit Profile"})}),e.jsxs(G,{className:"max-w-md",children:[e.jsxs(J,{children:[e.jsx(ee,{children:"Edit Profile"}),e.jsx(se,{children:"Update your display name and bio for CivicSocial."})]}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:a=>{a.preventDefault(),g.mutate({firstName:p,lastName:v,bio:w,profileImageUrl:q})},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"edit-name",children:"First Name"}),e.jsx(k,{id:"edit-name",value:p,onChange:a=>U(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"edit-lastname",children:"Last Name"}),e.jsx(k,{id:"edit-lastname",value:v,onChange:a=>L(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"edit-bio",children:"Bio"}),e.jsx(ae,{id:"edit-bio",value:w,onChange:a=>K(a.target.value),rows:3})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(x,{type:"submit",disabled:g.isPending,children:g.isPending?"Saving...":"Save"})]})]})]})]})]}):e.jsx("div",{className:"text-center text-muted-foreground",children:"Login to view your profile."})}export{Ee as default};
