import{j as e}from"./ui-CDUWW_Ri.js";import{r as l}from"./vendor-1XCZ5AD1.js";import{z as A,q as W,p as X,E as Z,K as J,r as d,g as u,j,Q as _,U as ee,P as se,h as S,i as T,v as c,D as ae,a as te,b as ie,c as re,W as F,X as L,Y as M,I as ne,y as o,B as x,af as le,M as ce,a1 as oe,Z as me}from"./index-B1N5ipvw.js";import{T as de,a as xe,b as p,c as g}from"./tabs-DCXTq-v-.js";import{U as he}from"./UnifiedSocialPost-BJC-URkV.js";import{T as ue}from"./trending-up-SM76QbfH.js";import{C as je}from"./clock-DrrNsXjf.js";import{G as pe}from"./globe-5nKa9HDV.js";import{S as ge}from"./smile-BOxLZwvS.js";import{S as ye}from"./share-D4plwUTe.js";import{B as Ne}from"./bookmark-5HpOKgBm.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=A("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=A("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);function De(){var k;const{user:m}=W(),{toast:i}=X(),r=Z(),[y,E]=l.useState("all"),[be,q]=l.useState(!1),[we,B]=l.useState({content:"",type:"post",visibility:"public",tags:[]}),[h,f]=l.useState(null),[ke,Ce]=l.useState(!1),[b,Pe]=l.useState({type:"all",visibility:"all",sortBy:"recent"}),{data:n,isLoading:U}=J({queryKey:["social-posts",y,b],queryFn:async()=>{const s=new URLSearchParams({tab:y,...b});return(await o(`/api/social/posts?${s}`,"GET")).posts||[]}});d({mutationFn:async s=>{if(!m)throw new Error("Please log in to create posts");return o("/api/social/posts","POST",s)},onSuccess:()=>{i({title:"Post Created",description:"Your post has been published successfully."}),r.invalidateQueries({queryKey:["social-posts"]}),q(!1),B({content:"",type:"post",visibility:"public",tags:[]})},onError:s=>{console.error("Post creation error:",s),i({title:"Post Failed",description:s.message||"Failed to create post. Please check your connection and try again.",variant:"destructive"})}});const $=d({mutationFn:async({postId:s,action:a})=>o(`/api/social/posts/${s}/like`,"POST",{action:a}),onSuccess:()=>{r.invalidateQueries({queryKey:["social-posts"]})},onError:s=>{i({title:"Action Failed",description:s.message||"Failed to perform action.",variant:"destructive"})}}),D=d({mutationFn:async({postId:s,content:a})=>o(`/api/social/posts/${s}/comments`,"POST",{content:a}),onSuccess:()=>{r.invalidateQueries({queryKey:["social-posts"]}),i({title:"Comment Added",description:"Your comment has been posted."})},onError:s=>{i({title:"Comment Failed",description:s.message||"Failed to post comment.",variant:"destructive"})}}),I=d({mutationFn:async({postId:s,comment:a})=>o(`/api/social/posts/${s}/share`,"POST",{comment:a}),onSuccess:()=>{r.invalidateQueries({queryKey:["social-posts"]}),i({title:"Post Shared",description:"Your post has been shared successfully."})},onError:s=>{i({title:"Share Failed",description:s.message||"Failed to share post.",variant:"destructive"})}}),K=d({mutationFn:async({postId:s,action:a})=>o(`/api/social/posts/${s}/bookmark`,"POST",{action:a}),onSuccess:()=>{r.invalidateQueries({queryKey:["social-posts"]})},onError:s=>{i({title:"Bookmark Failed",description:s.message||"Failed to bookmark post.",variant:"destructive"})}}),Q=s=>{$.mutate({postId:s.id,action:s.isLiked?"unlike":"like"})},z=(s,a)=>{a.trim()&&D.mutate({postId:s,content:a})},H=s=>{I.mutate({postId:s.id})},O=s=>{K.mutate({postId:s.id,action:s.isBookmarked?"unbookmark":"bookmark"})},N=s=>s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.firstName?s.firstName:s.email?s.email.split("@")[0]:"Anonymous User",Y=s=>{switch(s==null?void 0:s.toLowerCase()){case"champion":return"bg-purple-500";case"expert":return"bg-blue-500";case"advocate":return"bg-green-500";case"active":return"bg-yellow-500";default:return"bg-gray-500"}},G=s=>{const a=new Date(s),t=Math.floor((new Date().getTime()-a.getTime())/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<2592e3?`${Math.floor(t/86400)}d ago`:a.toLocaleDateString()},w=({post:s})=>{var a,v,t,C,P;return e.jsx(u,{className:"mb-6 hover:shadow-md transition-shadow",children:e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(F,{className:"w-10 h-10",children:[e.jsx(L,{src:(a=s.user)==null?void 0:a.profileImageUrl}),e.jsx(M,{className:"bg-blue-600",children:(v=N(s.user)[0])==null?void 0:v.toUpperCase()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:N(s.user)}),((t=s.user)==null?void 0:t.isVerified)&&e.jsxs(c,{variant:"secondary",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),"Verified"]}),e.jsx(c,{className:`text-xs ${Y(((C=s.user)==null?void 0:C.civicLevel)||"")}`,children:((P=s.user)==null?void 0:P.civicLevel)||"Registered"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(je,{className:"w-3 h-3"}),G(s.createdAt),s.visibility!=="public"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx(pe,{className:"w-3 h-3"}),s.visibility]})]})]})]}),e.jsx(x,{variant:"ghost",size:"sm",children:e.jsx(le,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s.content}),s.imageUrl&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:s.imageUrl,alt:"Post image",className:"rounded-lg max-w-full h-auto"})}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:s.tags.map((R,V)=>e.jsxs(c,{variant:"outline",className:"text-xs",children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),R]},V))}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-600",children:[s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-3 h-3"}),s.location]}),s.mood&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3"}),s.mood]})]})]}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[s.likesCount," likes"]}),e.jsxs("span",{children:[s.commentsCount," comments"]}),e.jsxs("span",{children:[s.sharesCount," shares"]})]})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>Q(s),className:s.isLiked?"text-red-600":"",children:[e.jsx(oe,{className:`w-4 h-4 mr-2 ${s.isLiked?"fill-current":""}`}),"Like"]}),e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>f(s),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Comment"]}),e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>H(s),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Share"]}),e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>O(s),children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),s.isBookmarked?"Saved":"Save"]})]})]})})};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"CivicSocial Feed"}),e.jsx("p",{className:"text-gray-600",children:"Connect with fellow citizens and share your civic engagement"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"mb-6",children:e.jsx(he,{placeholder:"What's on your mind?",onPostCreated:()=>{r.invalidateQueries({queryKey:["social-posts"]})}})}),e.jsxs(de,{value:y,onValueChange:E,children:[e.jsxs(xe,{className:"grid w-full grid-cols-4",children:[e.jsx(p,{value:"all",children:"All Posts"}),e.jsx(p,{value:"friends",children:"Friends"}),e.jsx(p,{value:"trending",children:"Trending"}),e.jsx(p,{value:"my-posts",children:"My Posts"})]}),e.jsx(g,{value:"all",className:"mt-6",children:U?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading posts..."})]}):(n==null?void 0:n.length)===0?e.jsx(u,{children:e.jsxs(j,{className:"p-8 text-center",children:[e.jsx(_,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No posts yet"}),e.jsx("p",{className:"text-gray-600",children:"Be the first to share your civic thoughts and experiences!"})]})}):e.jsx("div",{children:n==null?void 0:n.map(s=>e.jsx(w,{post:s},s.id))})}),e.jsx(g,{value:"friends",className:"mt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Friends' Posts"}),e.jsx("p",{className:"text-gray-600",children:"Posts from your friends will appear here."})]})}),e.jsx(g,{value:"trending",className:"mt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Trending Posts"}),e.jsx("p",{className:"text-gray-600",children:"Most popular and engaging posts will appear here."})]})}),e.jsx(g,{value:"my-posts",className:"mt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(se,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"My Posts"}),e.jsx("p",{className:"text-gray-600",children:"Your posts will appear here."})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(u,{children:[e.jsx(S,{children:e.jsx(T,{className:"text-lg",children:"Your Activity"})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Posts Created"}),e.jsx("span",{className:"text-sm font-medium",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Likes Given"}),e.jsx("span",{className:"text-sm font-medium",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Comments Made"}),e.jsx("span",{className:"text-sm font-medium",children:"0"})]})]})]}),e.jsxs(u,{children:[e.jsx(S,{children:e.jsx(T,{className:"text-lg",children:"Trending Topics"})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"#CivicEngagement"}),e.jsx(c,{variant:"secondary",children:"Hot"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"#LocalPolitics"}),e.jsx(c,{variant:"secondary",children:"Trending"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"#CommunityAction"}),e.jsx(c,{variant:"secondary",children:"New"})]})]})})]})]})]}),e.jsx(ae,{open:!!h,onOpenChange:()=>f(null),children:e.jsxs(te,{className:"max-w-2xl",children:[e.jsx(ie,{children:e.jsx(re,{children:"Post Details"})}),h&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{post:h}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Comments"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(F,{className:"w-8 h-8",children:[e.jsx(L,{src:m==null?void 0:m.profileImageUrl}),e.jsx(M,{className:"bg-blue-600 text-xs",children:(k=N(m)[0])==null?void 0:k.toUpperCase()})]}),e.jsx("div",{className:"flex-1",children:e.jsx(ne,{placeholder:"Write a comment...",onKeyPress:s=>{s.key==="Enter"&&s.currentTarget.value.trim()&&(z(h.id,s.currentTarget.value),s.currentTarget.value="")}})})]}),e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No comments yet. Be the first to comment!"})]})]})]})]})})]})}export{De as default};
